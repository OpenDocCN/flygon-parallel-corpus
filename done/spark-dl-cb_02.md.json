["```scala\nsparknotebook\n```", "```scala\nfrom pyspark.sql import SparkSession\n\n```", "```scala\nspark = SparkSession.builder \\\n         .master(\"local\") \\\n         .appName(\"Neural Network Model\") \\\n         .config(\"spark.executor.memory\", \"6gb\") \\\n         .getOrCreate()\nsc = spark.sparkContext\n```", "```scala\ndf = spark.createDataFrame([('Male', 67, 150), # insert column values\n                            ('Female', 65, 135),\n                            ('Female', 68, 130),\n                            ('Male', 70, 160),\n                            ('Female', 70, 130),\n                            ('Male', 69, 174),\n                            ('Female', 65, 126),\n                            ('Male', 74, 188),\n                            ('Female', 60, 110),\n                            ('Female', 63, 125),\n                            ('Male', 70, 173),\n                            ('Male', 70, 145),\n                            ('Male', 68, 175),\n                            ('Female', 65, 123),\n                            ('Male', 71, 145),\n                            ('Male', 74, 160),\n                            ('Female', 64, 135),\n                            ('Male', 71, 175),\n                            ('Male', 67, 145),\n                            ('Female', 67, 130),\n                            ('Male', 70, 162),\n                            ('Female', 64, 107),\n                            ('Male', 70, 175),\n                            ('Female', 64, 130),\n                            ('Male', 66, 163),\n                            ('Female', 63, 137),\n                            ('Male', 65, 165),\n                            ('Female', 65, 130),\n                            ('Female', 64, 109)], \n                           ['gender', 'height','weight']) # insert header values\n```", "```scala\nfrom pyspark.sql import functions\n```", "```scala\ndf = df.withColumn('gender',functions.when(df['gender']=='Female',0).otherwise(1))\n```", "```scala\ndf = df.select('height', 'weight', 'gender')\n```", "```scala\nimport numpy as np\n```", "```scala\ndf.select(\"height\", \"weight\", \"gender\").collect()\n```", "```scala\ndata_array =  np.array(df.select(\"height\", \"weight\", \"gender\").collect())\n```", "```scala\ndata_array[0]\n```", "```scala\ndata_array[28]\n```", "```scala\nprint(data_array.max(axis=0))\nprint(data_array.min(axis=0))\n```", "```scala\n import matplotlib.pyplot as plt\n %matplotlib inline\n```", "```scala\nmin_x = data_array.min(axis=0)[0]-10\nmax_x = data_array.max(axis=0)[0]+10\nmin_y = data_array.min(axis=0)[1]-10\nmax_y = data_array.max(axis=0)[1]+10\n```", "```scala\n# formatting the plot grid, scales, and figure size\nplt.figure(figsize=(9, 4), dpi= 75)\nplt.axis([min_x,max_x,min_y,max_y])\nplt.grid()\nfor i in range(len(data_array)):\n    value = data_array[i]\n    # assign labels values to specific matrix elements\n    gender = value[2]\n    height = value[0]\n    weight = value[1]\n\n    # filter data points by gender\n    a = plt.scatter(height[gender==0],weight[gender==0], marker \n      = 'x', c= 'b', label = 'Female')\n    b = plt.scatter(height[gender==1],weight[gender==1], marker \n      = 'o', c= 'b', label = 'Male')\n\n   # plot values, title, legend, x and y axis\n   plt.title('Weight vs Height by Gender')\n   plt.xlabel('Height (in)')\n   plt.ylabel('Weight (lbs)')\n   plt.legend(handles=[a,b])\n```", "```scala\nnp.random.seed(12345)\n```", "```scala\nw1 = np.random.randn()\nw2 = np.random.randn()\nb= np.random.randn()\n```", "```scala\nz = 0.5 * w1 + 0.5 * w2 + b \n```", "```scala\nz = 0.5 * (-0.2047) + 0.5 * (0.47894) + (-0.51943) = -7.557\n```", "```scala\nX = data_array[:,:2]\ny = data_array[:,2]\n```", "```scala\nx_mean = X.mean(axis=0)\nx_std = X.std(axis=0)\n\n```", "```scala\n def normalize(X):\n     x_mean = X.mean(axis=0)\n     x_std = X.std(axis=0)\n     X = (X - X.mean(axis=0))/X.std(axis=0)\n     return X\n```", "```scala\nprint('standard deviation')\nprint(round(X[:,0].std(axis=0),0))\nprint('mean')\nprint(round(X[:,0].mean(axis=0),0))\n```", "```scala\ndata_array = np.column_stack((X[:,0], X[:,1],y))\n```", "```scala\ndef sigmoid(input):\n  return 1/(1+np.exp(-input))\n```", "```scala\nX = np.arange(-10,10,1)\n```", "```scala\nY = sigmoid(X)\n```", "```scala\nplt.figure(figsize=(6, 4), dpi= 75)\nplt.axis([-10,10,-0.25,1.2])\nplt.grid()\nplt.plot(X,Y)\nplt.title('Sigmoid Function')\nplt.show()\n```", "```scala\ndef sigmoid_derivative(x):\n    return sigmoid(x) * (1-sigmoid(x))\n```", "```scala\nplt.figure(figsize=(6, 4), dpi= 75)\nplt.axis([-10,10,-0.25,1.2])\nplt.grid()\nX = np.arange(-10,10,1)\nY = sigmoid(X)\nY_Prime = sigmoid_derivative(X)\nc=plt.plot(X, Y, label=\"Sigmoid\",c='b')\nd=plt.plot(X, Y_Prime, marker=\".\", label=\"Sigmoid Derivative\", c='b')\nplt.title('Sigmoid vs Sigmoid Derivative')\nplt.xlabel('X')\nplt.ylabel('Y')\nplt.legend()\nplt.show()\n```", "```scala\nlearningRate = 0.1\n```", "```scala\nallCosts = []\n```", "```scala\nplt.plot(all_costs)\nplt.title('Cost Value over 100,000 iterations')\nplt.xlabel('Iteration')\nplt.ylabel('Cost Value')\nplt.show()\n```", "```scala\nprint('The final values of w1, w2, and b')\nprint('---------------------------------')\nprint('w1 = {}'.format(w1))\nprint('w2 = {}'.format(w2))\nprint('b = {}'.format(b))\n```", "```scala\nfor i in range(len(data_array)):\n    random_individual = data_array[i]\n    height = random_individual[0]\n    weight = random_individual[1]\n    z = height*w1 + weight*w2 + b\n    predictedGender=sigmoid(z)\n    print(\"Individual #{} actual score: {} predicted score:                           {}\".format(i+1,random_individual[2],predictedGender))\n```", "```scala\ndef input_normalize(height, weight):\n    inputHeight = (height - x_mean[0])/x_std[0]\n    inputWeight = (weight - x_mean[1])/x_std[1]\n    return inputHeight, inputWeight\n```", "```scala\nscore = input_normalize(70, 180)\n```", "```scala\ndef predict_gender(raw_score):\n    gender_summation = raw_score[0]*w1 + raw_score[1]*w2 + b\n    gender_score = sigmoid(gender_summation)\n    if gender_score <= 0.5:\n        gender = 'Female'\n    else:\n        gender = 'Male'\n    return gender, gender_score\n```", "```scala\nx_min = min(data_array[:,0])-0.1\nx_max = max(data_array[:,0])+0.1\ny_min = min(data_array[:,1])-0.1\ny_max = max(data_array[:,1])+0.1\nincrement= 0.05\n\nprint(x_min, x_max, y_min, y_max)\n```", "```scala\nx_data= np.arange(x_min, x_max, increment)\ny_data= np.arange(y_min, y_max, increment)\nxy_data = [[x_all, y_all] for x_all in x_data for y_all in y_data]\n```", "```scala\nfor i in range(len(xy_data)):\n    data = (xy_data[i])\n    height = data[0]\n    weight = data[1] \n    z_new = height*w1 + weight*w2 + b\n    predictedGender_new=sigmoid(z_new)\n    # print(height, weight, predictedGender_new)\n    ax = plt.scatter(height[predictedGender_new<=0.5],\n            weight[predictedGender_new<=0.5],     \n            marker = 'o', c= 'r', label = 'Female')    \n    bx = plt.scatter(height[predictedGender_new > 0.5],\n            weight[predictedGender_new>0.5], \n            marker = 'o', c= 'b', label = 'Male') \n    # plot values, title, legend, x and y axis\n    plt.title('Weight vs Height by Gender')\n    plt.xlabel('Height (in)')\n    plt.ylabel('Weight (lbs)')\n    plt.legend(handles=[ax,bx])\n```"]
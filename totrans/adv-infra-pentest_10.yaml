- en: Insecure VPN Exploitation
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 不安全的VPN利用
- en: '**Virtual private networks** (**VPNs**) are very useful when it comes to transferring
    data in a secure way. VPNs enable information security, but they are still exposed
    to high risks from hackers, every day. If you want to learn how to secure VPNs,
    this chapter will guide you from the required fundamentals of cryptography to
    obtaining the skills you need to secure VPNs.'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: '**虚拟私人网络**（**VPN**）在安全传输数据方面非常有用。VPN可以实现信息安全，但仍然容易受到黑客的高风险。如果你想学习如何保护VPN，本章将从密码学的基本知识开始，帮助你获得保护VPN所需的技能。'
- en: 'This chapter will cover the following topics:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主题：
- en: Cryptography
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密码学
- en: VPN fundamentals
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: VPN基础知识
- en: Insecure VPN exploitation
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不安全的VPN利用
- en: Cryptography
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 密码学
- en: 'In the art of cryptology, we have two different sciences: cryptography and
    cryptanalysis. Cryptography secures information based on mathematical algorithms,
    while cryptanalysis deals with exposing ciphertexts created by cryptography systems.
    These two sciences  coexist side by side. More simply, cryptography deals with
    hiding information, and cryptanalysis breaks cryptosystems to reveal the hidden
    information. Cryptography is not a new science, it is old. There are some classical
    cryptography techniques, such as Sumerian cuneiform, Egyptian hieroglyphics, scytale,
    Vigenère cipher, the Caesar cipher, and the ROT13 cipher.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 在密码学艺术中，我们有两种不同的科学：密码学和密码分析。密码学基于数学算法保护信息，而密码分析则处理密码系统创建的密文。这两种科学并存。简单来说，密码学处理隐藏信息，而密码分析则破解密码系统以揭示隐藏信息。密码学并不是一门新科学，它很古老。有一些经典的密码学技术，比如苏美尔楔形文字、埃及象形文字、斯塞塔利、维吉尼亚密码、凯撒密码和ROT13密码。
- en: Cryptosystems
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 密码系统
- en: 'The implementation of cryptographic techniques is called a cryptosystem; sometimes
    it''s called a cipher system. The following diagram describes a simple cryptosystem.
    The sender encrypts the plaintext with an encryption algorithm, which is a mathematical
    process using an encryption key. The output of that operation generates a ciphertext
    that will be decrypted by the receiver, using a decryption algorithm and a decryption
    key, so the ciphertext will be readable as plaintext:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 加密技术的实施被称为密码系统；有时也被称为密码系统。以下图表描述了一个简单的密码系统。发送者使用加密算法对明文进行加密，这是一个使用加密密钥的数学过程。该操作的输出生成一个密文，接收者将使用解密算法和解密密钥对其进行解密，使密文可读为明文：
- en: '![](img/00307.jpeg)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00307.jpeg)'
- en: Ciphers
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 密码
- en: 'Ciphers are encrypted messages. Ciphers could be intercepted by attackers.
    We have two main types of cipher: classical and  modern. Let''s discover them
    one by one.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 密码是加密的消息。密码可能会被攻击者拦截。我们有两种主要类型的密码：经典和现代。让我们逐一发现它们。
- en: Classical ciphers
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 经典密码
- en: 'This type existed before the era of computers, and it has the following two
    divisions:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 这种类型存在于计算机时代之前，有以下两个分支：
- en: '**Transposition**: It uses permutation. The plaintext is rearranged to another
    format. The characters are still the same but in different positions.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**置换**：它使用排列。明文被重新排列成另一种格式。字符仍然相同，但位置不同。'
- en: '**Substitution**: It uses character substitution, in other words, replacing
    a character with another one, such as, replacing *O* with *M*. The replacement
    algorithm should be known by the sender and the receiver. The ROT13 andCaesar
    ciphers are two examples of substitution ciphers.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**替换**：它使用字符替换，换句话说，用另一个字符替换一个字符，比如用*M*替换*O*。替换算法应该由发送者和接收者知道。ROT13和凯撒密码是替换密码的两个例子。'
- en: ROT13 is a substitution cipher where the positions of characters in the plaintext
    are shifted by 13 places. So, if the plaintext is *HELLO,*then the ciphertext
    should be *URYYB,* as shown*:*
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: ROT13是一种替换密码，其中明文中字符的位置向后移动了13个位置。因此，如果明文是*HELLO*，那么密文应该是*URYYB*，如下所示：
- en: '*![](img/00308.gif)*'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '*![](img/00308.gif)*'
- en: 'The Caesar cipher is a substitution cipher used by Julius Caesar where each
    character of the plaintext message is shifted by a predefined number of places.
    As a demonstration, let''s suppose that the shifting number is **2**, then the
    ciphertext of *HELLO,* for example, will be*JGNNQ,* as shown here. This cipher
    can be easily broken, and you can try a maximum of 25 shifts until you find a
    readable text:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 凯撒密码是由**朱利叶斯·凯撒**使用的替换密码，其中明文消息的每个字符都向前移动了预定义的位置数。举个例子，假设移动的数字是**2**，那么*HELLO*的密文将是*JGNNQ*，如下所示。这种密码很容易被破解，你可以尝试最多25次移位，直到找到可读的文本：
- en: '![](img/00309.gif)'
  id: totrans-20
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00309.gif)'
- en: Modern ciphers
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 现代密码
- en: 'Modern ciphers are again divided into two types:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 现代密码再次分为两种类型：
- en: '**Block ciphers**: These process information in blocks. Each block will be
    processed in encryption and decryption, individually. The **Data Encryption Standard**
    (**DES**) is one of the most used block ciphers, based on the Feistel cipher,
    which is developed by an IBM researcher, Horst Feistel, to try building an ideal
    block cipher structure that implements Claude Shannon''s **substitution-permutation**
    (**S-P**) networks. The following graph illustrates the Feistel Structure:'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**分组密码**：这些按块处理信息。每个块将分别进行加密和解密。**数据加密标准**（**DES**）是最常用的分组密码之一，基于费斯特尔密码，由IBM研究员Horst
    Feistel开发，试图构建实现克劳德·香农的**替换-置换**（**S-P**）网络的理想分组密码结构。以下图表说明了费斯特尔结构：'
- en: '![](img/00310.jpeg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00310.jpeg)'
- en: '**Stream ciphers**: These process information bit-by-bit, or byte-by-byte in
    encryption and decryption. To encrypt a message, for example, a keystream is generated
    using a seed key with the same size as the message, and later the encryption occurs.
    The following graph illustrates the two Cipher categories:'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**流密码**：这些按位或按字节处理信息，在加密和解密中。例如，要加密一条消息，会使用一个与消息大小相同的种子密钥生成一个密钥流，然后进行加密。以下图表说明了两种密码类别：'
- en: '![](img/00311.jpeg)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00311.jpeg)'
- en: Kerckhoffs' principle for cryptosystems
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 克尔克霍夫密码系统原则
- en: 'In order to check whether you have a good and secure cryptosystem, a Dutch
    cryptographer called Auguste Kerckhoffs proposed a set of laws and principles
    for the design of a secure cryptosystem. These articles were published in an 1883
    article, *Military Cryptography*. If you want to read the full text, have a look
    at Auguste Kerckhoffs, *La cryptographie militaire,* Journal des sciences militaires,
    vol. IX, pp. 5–38 II, Desiderata de la cryptographie militaire, January 1883\.
    Kerckhoffs'' six principles for cryptosystems are shown here:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00312.gif)'
  id: totrans-29
  prefs: []
  type: TYPE_IMG
- en: 'Here are the six principles translated into English :'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: The cryptosystem should be unbreakable practically, if not mathematically
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The falling of the cryptosystem into the hands of an intruder should not lead
    to any compromise of the system, preventing any inconvenience to the user
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The key should be easily communicable, memorable, and changeable
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The ciphertext should be transmissible by telegraph, an insecure channel
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The encryption apparatus and documents should be portable and operable by a
    single person
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, it is necessary that the system be easy to use, requiring neither mental
    strain nor the knowledge of a long series of rules to observe
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cryptosystem types
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When it comes to cryptosystems, we have two major categories based on encryption-decryption
    keys—symmetric and asymmetric cryptosystems. If the system uses the same key for
    both encryption and decryption, it would be a symmetric cryptosystem, otherwise,
    the cryptosystem is asymmetric, because the key used in encryption is not the
    same as the key used in decryption.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: Symmetric cryptosystem
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The various types of symmetric cryptosystems are as follows:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: '**Data Encryption Standard (DES)**: This has been developed by IBM. It started
    as Lucifer encryption and was later published by the **National Institute of Standards
    and Technology** (**NIST**). This encryption uses a 56-bit key:'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/00313.gif)'
  id: totrans-42
  prefs: []
  type: TYPE_IMG
- en: 'The round function is described in the following workflow:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00314.gif)'
  id: totrans-44
  prefs: []
  type: TYPE_IMG
- en: 'The key generation is done using the following workflow:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00315.gif)'
  id: totrans-46
  prefs: []
  type: TYPE_IMG
- en: 'The initial and final permutations are done by two inversed permutation boxes
    (P-boxes):'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00316.gif)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
- en: '**Triple-DES (3DES)**: This encryption is an enhanced version of DES. It uses
    a 168-bit key because the user generates three keys, k1, k2, and k3\. The first
    key, k1, is used to encrypt a single DES. The second key, k2, is used to decrypt
    the output of the first step. The final key, k3, is used to encrypt the previous
    step, a single DES:'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/00317.gif)'
  id: totrans-50
  prefs: []
  type: TYPE_IMG
- en: '**Advanced Encryption Standard (AES)**: AES is a DES  replacement. It is faster
    (about six times faster) and stronger. It uses the Rijndael cipher:'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/00318.jpeg)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
- en: '**Rivest Cipher 5 (RC5)**: This is an asymmetric cryptosystem developed by
    an MIT professor, Ronald Rivest. RC5 is composed of the following three major
    components:'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Key expansion algorithm
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Encryption algorithm:'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '>![](img/00319.gif)'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: 'Decryption algorithm:'
  id: totrans-57
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/00320.gif)'
  id: totrans-58
  prefs: []
  type: TYPE_IMG
- en: RC6 is derived from RC5, with a block size of 128 bits and a flexible key size.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: Asymmetric cryptosystem
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Following are the algorithms of Asymmetric cryptosystem:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: '**Rivest-Shamir-Adleman (RSA)**: RSA is one of the most widely used cryptosystems
    on the internet. It was developed by Ron Rivest, Adi Shamir, and Leonard Adleman
    at MIT. When using RSA, a pair of keys will be generated, a private key, and a
    public key.'
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Diffie-Hellman key exchange**: The Diffie-Hellman key exchange is a way of
    creating a key without sharing and exchanging information during this operation.'
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The basic idea works like this:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: Select two prime numbers,*g* and *p*
  id: totrans-65
  prefs:
  - PREF_OL
  - PREF_OL
  type: TYPE_NORMAL
- en: Compute *ga mod p* and send the output
  id: totrans-66
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The other key computes *gb mod p* and sends the output **B**
  id: totrans-67
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Compute *Ba mod p*
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The same on the other key computes *Ab mod p*
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/00321.jpeg)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
- en: '**El Gamal**: El Gamal is a cryptosystem based on the Diffie–Hellman key exchange'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hash functions and message integrity
  id: totrans-72
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Hash functions are mathematical  functions that take an arbitrarily sized input
    string, and generate a fixed-size output called a hash value or a message digest.
    A good hash function
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 哈希函数是数学函数，它接受任意大小的输入字符串，并生成固定大小的输出，称为哈希值或消息摘要。一个好的哈希函数
- en: should calculate hashes easily; it will be very difficult to calculate the plaintexts
    of a given
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 应该容易计算哈希；计算给定的明文将非常困难
- en: hash, and it does not generate the same hash for two different inputs, except
    in rare cases.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 哈希，对于两个不同的输入，它不会生成相同的哈希，除非在罕见情况下。
- en: '![](img/00322.jpeg)'
  id: totrans-76
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00322.jpeg)'
- en: 'There are many well-known hash functions used nowadays; they are as follows:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 现在有许多知名的哈希函数；它们如下：
- en: '**Hashed message authentication code**'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**散列消息认证码**'
- en: '**Message Digest** (**MD2**)'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**消息摘要**（**MD2**）'
- en: '**Message Digest** (**MD4**)'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**消息摘要**（**MD4**）'
- en: '**Message Digest** (**MD5**), if you want to encrypt or decrypt a plaintext
    you can use [http://md5decrypt.net/en/](http://md5decrypt.net/en/) shown here:'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**消息摘要**（**MD5**），如果您想加密或解密明文，可以使用[http://md5decrypt.net/en/](http://md5decrypt.net/en/)如下所示：'
- en: '![](img/00323.jpeg)'
  id: totrans-82
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00323.jpeg)'
- en: '**Secure Hash Algorithm** (**SHA**)'
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**安全哈希算法**（**SHA**）'
- en: '**Whirlpool**'
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Whirlpool**'
- en: '**HAVAL**'
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**HAVAL**'
- en: '**RIPEMD**'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**RIPEMD**'
- en: Digital signatures
  id: totrans-87
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数字签名
- en: 'The main goal of digital signatures is to verify the authenticity and integrity
    of a message or document. You can see it as an electronic fingerprint. The following
    graph shows the steps to sign a document:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 数字签名的主要目标是验证消息或文档的真实性和完整性。您可以将其视为电子指纹。以下图表显示了签署文件的步骤：
- en: '![](img/00324.jpeg)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00324.jpeg)'
- en: Steganography
  id: totrans-90
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 隐写术
- en: 'Steganography is the art of hiding messages in a human-readable medium, such
    as image files, videos, texts, and so on. The changes should be unnoticeable by
    sight, to mask the message behind the hosted file. The two types of steganography
    are as follows:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 隐写术是将消息隐藏在人类可读的媒介中的艺术，如图像文件、视频、文本等。这些变化在视觉上应该是不可察觉的，以掩盖承载文件后面的消息。隐写术有两种类型：
- en: 'Text steganography:'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 文本隐写术：
- en: Line-shift coding
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 行移编码
- en: Word-shift coding
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 词移编码
- en: Feature coding
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特征编码
- en: 'Image steganography:'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 图像隐写术：
- en: '**Least significant bit** (**LSB**): Hiding 1 bit of data in every pixel of
    8-bit images and 3 bits of data in every pixel of 24-bit images. You can use `steglsb`
    to perform LSB steganography:'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**最低有效位**（**LSB**）：在8位图像的每个像素中隐藏1位数据，在24位图像的每个像素中隐藏3位数据。您可以使用`steglsb`执行LSB隐写术：'
- en: '![](img/00325.jpeg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00325.jpeg)'
- en: '**Spread spectrum image steganography (SSIS)**'
  id: totrans-99
  prefs:
  - PREF_UL
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**扩频图像隐写术（SSIS）**'
- en: '**F5 algorithm**'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**F5算法**'
- en: Key management
  id: totrans-101
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 密钥管理
- en: 'Key management is the process of protecting encryption keys. In order to ensure
    this protection, a life cycle must be maintained, as shown:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 密钥管理是保护加密密钥的过程。为了确保这种保护，必须维护一个生命周期，如下所示：
- en: Key creation
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥创建
- en: Key protection and custody
  id: totrans-104
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥保护和监管
- en: Key rotation
  id: totrans-105
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥轮换
- en: Key destruction
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥销毁
- en: Key escrow
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 密钥托管
- en: '![](img/00326.gif)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00326.gif)'
- en: Cryptographic attacks
  id: totrans-109
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 密码攻击
- en: 'In order to retrieve the plaintexts of information, attackers and cryptanalysts
    are using many techniques:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检索信息的明文，攻击者和密码分析师使用了许多技术：
- en: '**Brute force attack (BFA)**: During this attack, the attacker will try all
    the key combinations to retrieve the key'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**穷举攻击（BFA）**：在此攻击期间，攻击者将尝试所有密钥组合以检索密钥'
- en: '**Dictionary attack**: In this attack, the attacker uses prepared dictionaries
    and tries the words in them'
  id: totrans-112
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**字典攻击**：在此攻击中，攻击者使用准备好的字典并尝试其中的单词'
- en: '**Birthday attack**: In the birthday attack, the attacker uses hash collision'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**生日攻击**：在生日攻击中，攻击者使用哈希碰撞'
- en: '**Ciphertext only attack (COA)**: In this attack, the attacker possesses the
    ciphertexts, and he only needs to determine the key'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**仅密文攻击（COA）**：在此攻击中，攻击者拥有密文，他只需要确定密钥'
- en: '**Known plaintext attack (KPA)**: The attacker uses what we call linear cryptanalysis
    to retrieve the missing plaintexts from ciphers, while he knows some partially
    plaintexts of the cipher'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**已知明文攻击（KPA）**：攻击者使用我们称之为线性密码分析来从密码中检索缺失的明文，同时他知道密码的部分明文'
- en: '**Chosen plaintext attack (CPA)**: The attacker uses differential cryptanalysis
    to retrieve the key after choosing the ciphertext and plaintexts by themselves'
  id: totrans-116
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**已选择明文攻击（CPA）**：攻击者在选择密文和明文后使用差分密码分析来检索密钥'
- en: '**Side channel attack (SCA)**: The attacker uses hardware to attack the cryptosystem,
    using power consumption or CPU cycles to exploit the weakness in the physical
    implementation of the cryptosystem'
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**侧信道攻击（SCA）**：攻击者使用硬件攻击密码系统，利用功耗或CPU周期来利用密码系统物理实现的弱点'
- en: '**Timing attack**: The attacker analyzes the computing times of cryptographic
    algorithms'
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**时序攻击**：攻击者分析加密算法的计算时间'
- en: '**Power analysis attack**: This is the same as a timing attack, but instead
    of studying the time, the attacker analyzes the power consumption'
  id: totrans-119
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**功率分析攻击**：这与时序攻击相同，但攻击者分析的是功耗'
- en: '**Fault analysis attack**: The attacker studies errors in the cryptosystem
    in order to gather more information'
  id: totrans-120
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**故障分析攻击**：攻击者研究密码系统中的错误以收集更多信息'
- en: VPN fundamentals
  id: totrans-121
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: VPN基础知识
- en: When it comes to information technology, cryptography plays a huge role in securing
    information in its different status. Various technical applications use cryptography
    on a daily basis, such as disk encryption, email security, and communication.
    VPNs are one of them. By definition, a VPN is a logical network between two sites.
    The traffic of VPNs is encrypted.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 当涉及信息技术时，加密在保护不同状态的信息方面发挥着重要作用。各种技术应用每天都在使用加密，如磁盘加密、电子邮件安全和通信。VPN就是其中之一。按定义，VPN是两个站点之间的逻辑网络。VPN的流量是加密的。
- en: 'In encryption, we have the following two modes:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 在加密中，我们有以下两种模式：
- en: '**Link encryption**: In this mode, all the information is encrypted, and the
    message should be decrypted in every hop. In this case, the router should decrypt
    the message so it knows the routing information, encrypt it again, and forward
    it to the next hop.'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**End-to-end encryption**: In this mode, shown here, the information in the
    required headers is not encrypted so the routers, for example, don''t need to
    decrypt them, because the routing information is clear:'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/00327.gif)'
  id: totrans-126
  prefs: []
  type: TYPE_IMG
- en: Tunneling protocols
  id: totrans-127
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are two technologies that are used in VPNs—SSL and **Internet Protocol
    Security** (**IPSec**). We will discuss these two technologies in a detailed and
    comprehensive way, but now, let''s look at the different tunneling protocols:'
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
- en: '**Point-to-Point Tunneling Protocol** (**PPTP**)'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Layer 2 Tunneling Protocol** (**L2TP**)'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IPSec
  id: totrans-131
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'IPSec is a protocol suite that enables security between systems, and by security,
    I mean some of the three fundamental cornerstones of information security discussed
    in the first chapter: confidentiality and integrity, in addition to authentication
    and anti-replay protection. IPSec uses the following two protocols:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: '**Authentication Header (AH) protocol**: This protocol is used to authenticate
    the traffic and not encrypt it. The authentication is performed, using hash functions
    (MD5 or SHA1).'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Encapsulating Security Payload (ESP) protocol**: This protocol is also used
    for authentication, but it supports encryption as well.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'IPSec operates in the following two different modes:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: '**Tunnel mode**: In this mode, the entire packet is encapsulated and forwarded.
    It is widely used in VPNs. A new IP header is added on top of the original IP
    header.'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Transport mode**: This mode is used in end-to-end encryption between systems.
    An AH header is added to the IP header:'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/00328.gif)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
- en: 'The following diagram illustrates the two different protocols and the different
     modes:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00329.gif)'
  id: totrans-140
  prefs: []
  type: TYPE_IMG
- en: Secure Sockets Layer/Transport Layer Security
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Secure Sockets Layer** (**SSL**) is an application layer protocol. If you
    are using a modern browser in a secure mode, the connection between your browser
    and the web server is secured by SSL. The more secure version of SSL is **Transport
    Layer Security** (**TLS**). If a website is secured by an SSL certificate, then
    the HTTPS sign will appear in your URL bar:'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00330.gif)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
- en: 'The SLL/TLS operation is represented as follows:'
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00331.gif)'
  id: totrans-145
  prefs: []
  type: TYPE_IMG
- en: SSL attacks
  id: totrans-146
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This section will discuss the major SSL attacks that have happened over the
    years.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
- en: DROWN attack (CVE-2016-0800)
  id: totrans-148
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A DROWN attack is an encryption-breaking technique. When the attack was discovered,
    they found that more than 33% of HTTPS servers were vulnerable. Servers that still
    support SSLv2 are vulnerable to this attack. In a DROWN attack, the attacker sends
    probes with the same private key to decrypt the TLS communications. Thus, all
    the information will be exposed. Not only servers that support SSLv2 are vulnerable,
    but also an attacker can use a private key from another server that supports SSLv2
    to launch the attack.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
- en: 'To test whether your servers are vulnerable to a DROWN attack, you can use [https://pentest-tools.com/network-vulnerability-scanning/drown-ssl-scanner](https://pentest-tools.com/network-vulnerability-scanning/drown-ssl-scanner):'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00332.jpeg)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
- en: To defend against a DROWN attack, it is recommended you disable SSLv2 on the
    servers; ensure that the private keys are not used by any other service that allows
    SSLv2 connections and upgrade the OpenSSL cryptographic library.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: POODLE attack (CVE-2014-3566)
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The **Padding Oracle On Downgraded Legacy Encryption** (**POODLE**) attack
    was discovered in 2014\. This attack exploits the fact that many servers  support SSLv3
    on one hand and a block padding vulnerability on the other hand. Following diagram
    demonstrates POODLE attack:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00333.gif)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
- en: In general, as a first step, a client sends the supported TLS versions. In this
    case, the attacker intercepts the traffic performing a man-in-the-middle attack
    and mimics the server, until the connection is downgraded to SSLv3\. If the connection
    is established, the attacker exploits a cipher block chaining vulnerability, by
    manipulating the padding bytes to perform the POODLE attack.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，作为第一步，客户端发送支持的TLS版本。在这种情况下，攻击者拦截流量进行中间人攻击，并模拟服务器，直到连接降级为SSLv3。如果连接建立，攻击者利用密码块链接漏洞，通过操纵填充字节执行POODLE攻击。
- en: 'If you want to test whether your servers are vulnerable to POODLE attacks,
    you can use the `ssl-poodle` nmap script or simply test it online using the previous
    website:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 如果您想测试您的服务器是否容易受到POODLE攻击，您可以使用`ssl-poodle` nmap脚本，或者简单地在线测试使用之前的网站：
- en: '![](img/00334.jpeg)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00334.jpeg)'
- en: To defend against a POODLE attack, you need to disable SSLv3 on your servers
    and upgrade the clients, because upgraded clients use TLS fallback **Signaling
    Cipher Suite Value** (**SCSV**) in order to prevent protocol downgrade attacks.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 要防御POODLE攻击，您需要在服务器上禁用SSLv3并升级客户端，因为升级的客户端使用TLS回退**信号密码套件值**（**SCSV**）以防止协议降级攻击。
- en: BEAST attack  (CVE-2011-3389)
  id: totrans-160
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: BEAST攻击（CVE-2011-3389）
- en: The **Browser Exploit Against SSL/TLS** (**BEAST**) attack was discovered in
    2011\. In a BEAST attack, the attacker uses CPA after exploiting a cipher block
    chaining vulnerability in TLS, by performing a man-in-the-middle attack. To defend
    against a BEAST attack, upgrade the TLS version.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '**浏览器针对SSL/TLS的利用**（**BEAST**）攻击于2011年被发现。在BEAST攻击中，攻击者利用TLS中的密码块链接漏洞进行CPA，通过进行中间人攻击。要防御BEAST攻击，升级TLS版本。'
- en: CRIME attack (CVE-2012-4929)
  id: totrans-162
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: CRIME攻击（CVE-2012-4929）
- en: 'In a **Compression Ratio Info-leak Made Easy** (**CRIME**) attack, the attacker
    exploits a vulnerability in TLS compression. Following diagram demonstrates CRIME
    attack:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 在**压缩比例信息泄漏简化**（**CRIME**）攻击中，攻击者利用TLS压缩中的漏洞。以下图表演示了CRIME攻击：
- en: '![](img/00335.gif)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00335.gif)'
- en: This compression is basically and, optionally, used to reduce the bandwidth
    using the DEFLATE algorithm, for example. To defend against this attack, make
    sure that your browser is up to date.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 这种压缩基本上是可选的，用于使用DEFLATE算法等减少带宽。要防御此攻击，请确保您的浏览器是最新的。
- en: BREACH attack (CVE-2013-3587)
  id: totrans-166
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: BREACH攻击（CVE-2013-3587）
- en: In a **Browser Reconnaissance and Exfiltration via Adaptive Compression of Hypertext**
    (**BREACH**) attack, the attacker exploits an HTTP compression.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 在**通过自适应压缩的浏览器侦察和泄露**（**BREACH**）攻击中，攻击者利用HTTP压缩。
- en: Heartbleed attack
  id: totrans-168
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 心脏出血攻击
- en: 'In a Heartbleed attack, the attackers exploit the TLS heartbeat extension in
    the  OpenSSL library. This extension is used to always ensure that the connection
    between two systems is alive. The request payload is composed of the data and
    the size of it. The attackers exploit this format to force the server to send
    the requested size from leaked data from memory:'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 在心脏出血攻击中，攻击者利用OpenSSL库中的TLS心跳扩展。该扩展用于始终确保两个系统之间的连接是活动的。请求有效载荷由数据和其大小组成。攻击者利用这种格式迫使服务器从内存泄漏的数据中发送请求的大小：
- en: '![](img/00336.gif)'
  id: totrans-170
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00336.gif)'
- en: 'In order to test your servers, try the usual website:'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 为了测试您的服务器，请尝试通常的网站：
- en: '![](img/00337.jpeg)'
  id: totrans-172
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00337.jpeg)'
- en: Qualys SSL Labs
  id: totrans-173
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Qualys SSL实验室
- en: 'To test your servers against SSL attacks, you can try Qualys SSL Labs. To try
    it, just visit [https://ssllabs.com/](https://ssllabs.com/):'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: '要测试您的服务器是否容易受到SSL攻击，您可以尝试Qualys SSL实验室。要尝试，请访问[https://ssllabs.com/](https://ssllabs.com/):'
- en: '![](img/00338.jpeg)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00338.jpeg)'
- en: 'Click on Test your server and put in your website:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 点击测试您的服务器并输入您的网站：
- en: '![](img/00339.jpeg)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00339.jpeg)'
- en: 'The website will scan the addresses related to the entered website:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 该网站将扫描与输入的网站相关的地址：
- en: '![](img/00340.jpeg)'
  id: totrans-179
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00340.jpeg)'
- en: 'A report will be generated to give you a detailed SSL report and an overall
    rating:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 将生成一份报告，为您提供详细的SSL报告和总体评分：
- en: '>![](img/00341.jpeg)'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: '>![](img/00341.jpeg)'
- en: Summary
  id: totrans-182
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, you learned how to secure VPNs. Like every other chapter, we
    started from the basics and went from cryptology techniques to VPNs, because having
    a clear understanding of the aspects of a technology will give penetration testers
    a clearer vision to know how to secure that technology.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，您学会了如何保护VPN。与每一章一样，我们从基础知识开始，从密码学技术到VPN，因为对技术的各个方面有清晰的理解将使渗透测试人员更清晰地了解如何保护该技术。
- en: In the next chapter, we will discuss common security vulnerabilities which may
    be present in switches and routers and offers advice on keeping network devices
    secure.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将讨论交换机和路由器中可能存在的常见安全漏洞，并提供有关保持网络设备安全的建议。

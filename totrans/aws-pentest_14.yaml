- en: '*Chapter 11*: Staying Out of Trouble'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Pentesting can be very intrusive on AWS systems, and can also lead to legal
    issues if not executed correctly. When pentesting AWS, it's crucial to understand
    what you as a pentester can and cannot perform on an AWS system. These types of
    attacks bring systems down during a pentest and ruin your reputation, while also
    potentially destroying client systems and creating substantial revenue loss for
    both the pentesting company and the targeted client.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: This chapter will discuss **Denial of Service** (**DoS**) and flooding attacks
    and how they work. Understanding how these attacks work illustrates the severity
    of the attacks and why we should stay away from them.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: We will finish the chapter by discussing stress testing, which is also sometimes
    referred to as load testing, and get a high-level view as to what stress testing
    is and whether customers should be worried.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: 'We will cover the following topics in this chapter:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: Prohibited activities
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Exhausting services via DoS
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Understanding flooding
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Avoiding legal issues
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Stress testing
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Prohibited activities
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: It's essential to understand what activities are allowed and which ones are
    not when it comes to pentesting. As we have stated throughout this book, this
    is what we call *within scope* and *out of scope*. When we mention systems that
    are within scope, we are discussing what we can test, at what times, and how much
    impact we can have on those within scoped hosts. However, it is just as important
    to know what is out of scope as well. Knowing what is out of scope ensures that
    you only test what the client is requesting and keeps you and your team from dodging
    any type of legal fines or punishment.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: The following sections are going to discuss what AWS states as prohibited activities
    toward their infrastructure and service. Remember that part of the shared security
    model relies on AWS and its uptime for its hardware – so AWS has a say in how
    its product is tested.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: Let's move forward and discuss the prohibited attacks on AWS – **DoS** and **flooding**.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: Exhausting services via DoS
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: DoS and **Distributed Denial of Service** (**DDoS**) are disruptive attacks
    that target various systems, such as websites and applications, and at times can
    also target users. A DoS attack generates a large volume of traffic that aims
    to overwhelm a target and render it useless or take it offline. A DDoS attack
    executes the same attack, only it does it from multiple compromised or controlled
    hosts – known as a **botnet** – to attack the target.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: Important note
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: 'A large amount of controlled or compromised hosts are commonly known as a **botnet**.
    AWS has an older but interesting article on botnets that is located here: [https://aws.amazon.com/security/security-bulletins/zeus-botnet-controller/](https://aws.amazon.com/security/security-bulletins/zeus-botnet-controller/).'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: 'DoS and DDoS attacks will attack multiple layers of the **Open Systems Interconnection**
    (**OSI**) model; however, the more common attacks that we see occur at layer **3**,
    layer **4**, layer **6**, and layer **7**. The following screenshot is from AWS''s
    website and shows the various layers:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: '![Figure 11.1 – Layers for AWS'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: '](img/Figure_11.01_B15630.jpg)'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: Figure 11.1 – Layers for AWS
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: 'The layers **3**, **4**, **6**, and **7** illustrate the most prominent layers
    for disruptive attacks and can be grouped into two different layers. Grouping
    these eases the mitigation process because it allows us to apply mitigation techniques
    to multiple layers that reside in one group. We join the layers into the following
    groups:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: '**Infrastructure layer** (layers **3** and **4**)'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Application layer** (layers **6** and **7**)'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Having our groups in mind, let's discuss them and what services they target
    in regard to AWS.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: Infrastructure-layer attacks
  id: totrans-26
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Infrastructure-layer attacks focus on attacking the network layer (**3**) and
    transport layer (**4**). Some of the more common attacks we see in AWS that attack
    this layer involve SYN flooding and UDP flooding – which we will discuss further
    in the *Understanding flooding* section of this chapter – which aim to bring services
    down at this layer. This entails disrupting any connections that are established
    over the network via TCP, UDP, and IP, such as establishing connections with other
    nodes within your AWS environment.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 基础架构层攻击侧重于攻击网络层（**3**）和传输层（**4**）。在AWS中，我们看到的一些更常见的攻击涉及SYN洪水和UDP洪水——我们将在本章的*了解洪水*部分进一步讨论——旨在使该层的服务崩溃。这包括通过TCP、UDP和IP建立的任何连接的中断，例如在AWS环境中与其他节点建立连接。
- en: Now, let's discuss the next layer, the application layer, and consider what
    it would disrupt in regard to AWS.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们讨论下一层，即应用层，并考虑它对AWS的影响。
- en: Application-layer attacks
  id: totrans-29
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 应用层攻击
- en: Attacks that occur at the application layer are typically less common; however,
    they do present their own issues. While these types of DoS attacks can produce
    large traffic values to bring services down, they also can be something as simple
    as changing the integrity of a file, policy, or another type of data that allows
    access and authorization to a resource. We have seen attack situations and methods
    throughout this book that illustrate denying service by changing an S3 policy
    or changing SSH keys on an EC2 instance.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 应用层发生的攻击通常较少见；然而，它们也存在自己的问题。虽然这些类型的DoS攻击可以产生大量流量值以使服务崩溃，但它们也可能是简单的改变文件、策略或其他类型的数据的完整性，从而允许访问和授权资源。我们在本书中已经看到了一些攻击情况和方法，这些情况说明通过改变S3策略或更改EC2实例上的SSH密钥来拒绝服务。
- en: The application-layer attack primarily targets SSH and HTTP when targeting AWS.
    This means that APIs and access to EC2 instances could be vulnerable if not secured
    or protected correctly. We will discuss protections and mitigations further in
    the *Mitigating flood attacks and DoS* section of this chapter.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 应用层攻击主要针对AWS的SSH和HTTP。这意味着如果API和EC2实例的访问没有得到正确的保护，它们可能会受到攻击。我们将在本章的*减轻洪水攻击和DoS*部分进一步讨论保护和减轻措施。
- en: Now that we understand the layers, let's move forward and discuss flooding and
    what that means during a pentest.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们了解了各层，让我们继续讨论洪水以及在渗透测试期间的含义。
- en: Understanding flooding
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 了解洪水
- en: Flooding is a simple but effective tactic that malicious and curious users perform
    by sending an overload of packets to a target host in the hope of overwhelming
    the host. Another portion of the flood that makes it **simple** is that it uses
    the shortest path to its target by flooding every path within a network, or in
    our case, within our **VPC** and cloud environment. This means that when flooding
    attacks occur, they could potentially affect other hosts besides that target because
    the flood **sprays** out to other nodes to find the shortest path.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 洪水是一种简单但有效的策略，恶意和好奇的用户通过向目标主机发送大量数据包来希望淹没主机。洪水的另一个部分使其**简单**是它使用网络中的最短路径到达目标，或者在我们的情况下，到达我们的**VPC**和云环境。这意味着当洪水攻击发生时，它可能会影响除目标之外的其他主机，因为洪水会**喷射**到其他节点以找到最短路径。
- en: Additionally, flooding is a common technique in DoS attacks. A DoS attack's
    mission is to overwhelm and flood the network, system, or environment to where
    the availability is disrupted, and the service is brought down.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，洪水是DoS攻击中常见的技术。DoS攻击的任务是压倒和淹没网络、系统或环境，使可用性受到干扰，服务被关闭。
- en: Now, let's mention a few flooding techniques, as well as a few styles of DoS
    attacks.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们提到一些洪水技术，以及一些DoS攻击的风格。
- en: UDP flooding
  id: totrans-37
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: UDP洪水
- en: Port flooding involves an attack that targets a system's ports and overflows
    them with **User Data Protocol** (**UDP**) packets. Because UDP packets are connectionless,
    they can be sent in a flood that does not require any established connection from
    the target host, unlike the three-way **Transport Control Protocol** (**TCP**)
    handshake. When a target is sent an enormous amount of UDP packets, it could become
    overwhelmed and go offline. If the target host goes offline, a message stating
    **Destination Unreachable** will be sent back to us.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 端口洪水涉及攻击系统的端口并用**用户数据协议**（**UDP**）数据包溢出它们。由于UDP数据包是无连接的，它们可以以不需要目标主机建立任何已建立连接的洪水发送。当目标收到大量UDP数据包时，它可能会变得不堪重负并下线。如果目标主机下线，将向我们发送一条表明**目的地不可达**的消息。
- en: Discussing SYN floods and TCP handshakes
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 讨论SYN洪水和TCP握手
- en: An SYN flood, or TCP SYN flood, is a DoS attack that exploits that three-way
    TCP handshake by sending an overload of SYN requests without ever accepting an
    ACK request sent by the target. Essentially, what this does is leaves the target
    waiting for a response from the attacker while also processing the abundance of
    SYN requests coming from that attacker machine.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: SYN洪水，或TCP SYN洪水，是一种利用三向TCP握手的DoS攻击，通过发送大量SYN请求而不接受目标发送的ACK请求来进行攻击。基本上，这样做会让目标等待来自攻击者的响应，同时处理来自攻击者机器的大量SYN请求。
- en: 'To better understand the SYN flood, we need to understand the TCP handshake
    and how it works. The following steps highlight the three steps in how the TCP
    handshake is initiated between two nodes – which, in our case, could be a target
    and attacker if the attacker wanted to establish a connection:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 为了更好地理解SYN洪水，我们需要了解TCP握手及其工作原理。以下步骤突出了TCP握手在两个节点之间启动的三个步骤——在我们的情况下，这可能是目标和攻击者之间的连接：
- en: The attacker machine sends an SYN message to that target to request a connection
    to the target.
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 攻击者机器向目标发送一个SYN消息以请求与目标建立连接。
- en: The target sends an SYN-ACK request back to the attacker machine and acknowledges
    the request.
  id: totrans-43
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 目标向攻击者机器发送一个SYN-ACK请求并确认该请求。
- en: The attacker machine responds with an ACK message, and a connection is initiated.
  id: totrans-44
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 攻击者机器响应ACK消息，并启动连接。
- en: 'The following diagram illustrates the steps we just mentioned here and helps
    give a visual on the TCP three-way handshake:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 以下图表说明了我们刚才提到的步骤，并帮助直观地理解TCP三次握手：
- en: '![Figure 11.2 – TCP three-way handshake'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.2 - TCP三次握手'
- en: '](img/Figure_11.02_B15630.jpg)'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_11.02_B15630.jpg)'
- en: Figure 11.2 – TCP three-way handshake
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.2 - TCP三次握手
- en: 'Now that we understand how the handshake works, let''s discuss how this handshake
    can be exploited and used to attack our target. The following steps will highlight
    how the SYN flood is executed:'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们了解了握手的工作原理，让我们讨论一下如何利用这个握手来攻击我们的目标。以下步骤将突出显示SYN洪水是如何执行的：
- en: The attack initiates an SYN flood. The attacker sends multiple SYN requests,
    which are sent to that target server.
  id: totrans-50
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 攻击发起SYN洪水。攻击者发送多个SYN请求，这些请求发送到目标服务器。
- en: The target receives and responds to an overload of requests without receiving
    an ACK response from the attacking machine. While attempting to receive an ACK
    from the attacker machine, the target will still be overloaded with SYN requests
    from the attacker machine.
  id: totrans-51
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 目标接收并响应来自攻击机器的过载请求，而没有收到ACK响应。在试图从攻击者机器接收ACK时，目标仍将受到来自攻击者机器的SYN请求的过载。
- en: The service goes down and makes that target unable to process legitimate requests.
  id: totrans-52
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 服务中断，使目标无法处理合法请求。
- en: 'The next figure illustrates the three steps we just mentioned in our flooding
    methodology:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 下图说明了我们在洪水方法论中提到的三个步骤：
- en: '![Figure 11.3 – Abusing the three-way handshake with DoS'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.3 - 滥用三次握手的DoS'
- en: '](img/Figure_11.03_B15630.jpg)'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_11.03_B15630.jpg)'
- en: Figure 11.3 – Abusing the three-way handshake with DoS
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.3 - 滥用三次握手的DoS
- en: As we can see, flooding attacks can be hazardous if not mitigated correctly.
    Having a service down means a loss of revenue, loss of reputation, and a potential
    loss in employees' trust. We will explore these reasons more in just a bit; however,
    remember that while flooding is a dangerous attack, there is an excellent resolution
    for it within AWS.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们所看到的，如果不正确减轻洪水攻击，洪水攻击可能会带来危险。服务中断意味着收入损失、声誉损失和员工信任的潜在损失。我们将在稍后更详细地探讨这些原因；然而，请记住，尽管洪水是一种危险的攻击，但在AWS中有一个很好的解决方案。
- en: Now that we understand DoS, DDoS, and flooding attacks from a high level, let's
    mention how we mitigate these attacks from occurring. This is what we would recommend
    to our clients on how they could protect their systems from disruptive attacks.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们从高层次理解了DoS、DDoS和洪水攻击，让我们提到如何防止这些攻击发生。这是我们向客户推荐的如何保护其系统免受破坏性攻击的建议。
- en: Mitigating flood attacks and DoS
  id: totrans-59
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: 减轻洪水攻击和DoS
- en: The most basic understanding of floods and how to mitigate them is that most
    operating systems, such as Windows, will limit the ICMP responses and filter out
    the overload of requests. You can also use a more traditional approach and use
    a firewall solution to help mitigate these attacks. AWS provides a service called
    **AWS Firewall**, which acts as a **Web Application Firewall** (**WAF**) that
    can be used to filter out traffic to your AWS environment and APIs and prevent
    common exploits against your web applications.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 对洪水的最基本理解以及如何减轻其影响是，大多数操作系统（如Windows）会限制ICMP响应并过滤掉请求的过载。您也可以使用更传统的方法，使用防火墙解决方案来帮助减轻这些攻击。AWS提供了一项名为**AWS防火墙**的服务，它充当**Web应用程序防火墙**（**WAF**），可用于过滤您的AWS环境和API的流量，并防止针对您的Web应用程序的常见利用。
- en: There is another service, known as **AWS Shield**, that helps prevent DoS and
    DDoS attacks against any of your applications that are running within AWS. The
    two-tier service provides real-time detection and mitigations that prevent overloaded
    traffic sent to applications from actually causing any damage – which is awesome
    because AWS Shield essentially does all the heavy lifting and does not require
    you to have any additional AWS support.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 还有另一项名为**AWS Shield**的服务，它有助于防止针对在AWS中运行的任何应用程序的DoS和DDoS攻击。这两层服务提供了实时检测和减轻，以防止发送到应用程序的过载流量实际上造成任何损害
    - 这很棒，因为AWS Shield基本上承担了所有繁重的工作，而不需要您额外的AWS支持。
- en: So, how does AWS Shield work exactly, and why should it be something that is
    recommended to prevent any type of DoS attack?
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，AWS Shield究竟是如何工作的，为什么应该推荐它来防止任何类型的DoS攻击呢？
- en: Simply put, AWS Shield creates and provides real-time heuristic-based monitoring
    and inline mitigation. What this means is that AWS Shield uses advanced monitoring
    techniques that create baselines within the environment that are based on usual
    traffic, and it will report anything that deviates from that traffic. Additionally,
    it will also perform real-time mitigations on common and more frequent attacks,
    such as DoS and flood attacks. It will also provide more specific detection and
    advanced mitigation techniques that help hinder a more advanced style of attack,
    such as DDoS attacks.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 简而言之，AWS Shield创建并提供基于启发式的实时监控和内联减轻。这意味着AWS Shield使用先进的监控技术，在环境中创建基于通常流量的基线，并将报告任何偏离该流量的情况。此外，它还将对常见和更频繁的攻击进行实时减轻，例如DoS和洪水攻击。它还将提供更具体的检测和高级的减轻技术，有助于阻碍更高级的攻击方式，例如DDoS攻击。
- en: 'You can discover more about AWS Shield and how it can help you with mitigation
    strategies here: [https://aws.amazon.com/shield/](https://aws.amazon.com/shield/).'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以在这里了解更多关于AWS Shield以及它如何帮助您制定减轻策略：[https://aws.amazon.com/shield/](https://aws.amazon.com/shield/)。
- en: 'Another way to mitigate against any disruptive attacks is by reducing the attack
    surface of your AWS environments. This means ensuring that EC2 instances are not
    publicly available unless they need to be based on a business reason. The less
    exposure that applications have to the internet, the less prone they are to being
    discovered and attacked. We can also help by scaling to help the load that the
    environments will take on by placing **load balancers** within the environment.
    The following diagram shows how a load balancer takes the load between four different
    nodes and distributes it between the four nodes based on what type of traffic
    they will be able to handle at that time:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 另一种减轻任何破坏性攻击的方法是减少AWS环境的攻击面。这意味着确保EC2实例不公开可用，除非基于业务原因需要。应用程序对互联网的暴露越少，它们被发现和攻击的可能性就越小。我们还可以通过放置负载均衡器在环境中来帮助承担环境将承受的负载。以下图表显示了负载均衡器如何在四个不同节点之间分配负载，并根据它们在那个时候能够处理的流量类型来分配负载：
- en: '![Figure 11.4 – Load balancing within AWS'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: '![图11.4 - AWS内的负载均衡'
- en: '](img/Figure_11.04_B15630.jpg)'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '](img/Figure_11.04_B15630.jpg)'
- en: Figure 11.4 – Load balancing within AWS
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 图11.4 - AWS内的负载均衡
- en: As you can see, instead of each node handling traffic on its own, the load balancer
    distributes the traffic based on how much traffic each node can handle.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，负载均衡器不是每个节点独立处理流量，而是根据每个节点能够处理的流量量来分发流量。
- en: One of the last things to mention, but also very important, is that you have
    trained AWS engineers that are able to implement security controls within the
    environment securely and efficiently. The best way your engineers will implement
    these controls is by understanding and knowing what is normal and what is abnormal
    traffic within an environment. This is why culture is such a significant portion
    of security not only in AWS but also in an enterprise itself.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 最后要提到的一点，但也非常重要的是，您必须有受过培训的AWS工程师，能够在环境中安全有效地实施安全控制。您的工程师实施这些控制的最佳方式是了解并知道环境中的正常流量和异常流量。这就是为什么文化在安全中如此重要，不仅在AWS中，也在企业本身。
- en: While culture is a huge influence, it's also important to know that insiders
    can have an influence and how their malicious hacker mindset can present issues
    within the organization. The next section is going to discuss the hacker mindset
    as it relates to DoS and DDoS attacks.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然文化是一个巨大的影响，但同样重要的是要知道内部人员可能会对组织产生影响，以及他们的恶意黑客心态如何在组织内部引发问题。接下来的部分将讨论黑客心态与DoS和DDoS攻击的关系。
- en: The attacker mindset for DoS and DDoS
  id: totrans-72
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: DoS和DDoS的攻击者心态
- en: There are many reasons why attackers execute disruptive attacks against victim
    targets. In this case, the threat actions would be the DoS or DDoS attack, which
    looks to directly create a nuisance that destroys the reputation of the company,
    or many times is used to create a political state if a political affiliate owns
    the AWS system.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 攻击者执行破坏性攻击的原因有很多。在这种情况下，威胁行为将是DoS或DDoS攻击，旨在直接制造破坏公司声誉的麻烦，或者很多时候用于制造政治状态，如果政治关联方拥有AWS系统。
- en: We mentioned in [*Chapter 3*](B15630_03_Final_ASB_ePub.xhtml#_idTextAnchor098),
    *Exploring Pentesting and AWS*, some of the various styles of attackers, such
    as insiders and outsiders. Those same attacker mindsets can be applied to reasons
    for executing DoS and flood attacks.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在[*第3章*](B15630_03_Final_ASB_ePub.xhtml#_idTextAnchor098)中提到，*探索渗透测试和AWS*，一些不同类型的攻击者，如内部人员和外部人员。这些相同的攻击者心态可以应用于执行DoS和洪水攻击的原因。
- en: Now that we understand more about the attacks that we need to stay away from,
    let's wrap up the chapter and discuss some of the legal issues you may face if
    going out of the scope of a pentest.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们更多地了解了我们需要远离的攻击，让我们结束本章，并讨论一些您可能会面临的法律问题，如果超出了渗透测试的范围。
- en: Avoiding legal issues
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 避免法律问题
- en: As we have seen throughout this book, pentesting can be very intrusive and at
    times can even be very dangerous if your team doesn't fully understand what is
    within the scope of the pentest, and can lead to fines or even actions that would
    be considered illegal under the **Computer Fraud and Abuse Act** (**CFAA**). Depending
    on who and what the pentest team is testing, you could also be breaking other
    laws, such as federal and state laws; however, that would depend on each pentest.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 正如我们在本书中所看到的，渗透测试可能会非常侵入性，有时甚至可能非常危险，如果您的团队不完全了解渗透测试的范围，可能会导致罚款，甚至可能会被认为违反《计算机欺诈和滥用法》（CFAA）而采取行动。根据渗透测试团队测试的对象和内容，您还可能违反其他法律，如联邦和州法律；然而，这将取决于每次渗透测试。
- en: This all being said, let's take a quick look at how we can stay out of trouble
    with both the law and our clients.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 说了这些，让我们快速看一下如何在法律和客户方面避免麻烦。
- en: Get-out-of-jail-free card
  id: totrans-79
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 免于监狱的牌
- en: This is one of the most significant fundamental factors in ensuring that you
    stay out of any legal conflict during a pentest. The get-out-of-jail-free card
    is essentially a piece of paper stating that a pentest team is authorized to pentest
    the target organization – however, it should also annotate **WHAT**, **WHERE**,
    and **WHEN** the pentest team is allowed to pentest. This is extremely important
    because pentesters may not be able to pentest during certain times due to high-value
    traffic times; they also may not be authorized for some pentest regions of the
    network or web applications hosted within the AWS environment.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这是确保在渗透测试期间避免任何法律冲突的最重要的基本因素之一。免于监狱的牌本质上是一张纸，说明渗透测试团队被授权对目标组织进行渗透测试 - 但是，它还应该注明渗透测试团队被允许进行渗透测试的“什么”，“在哪里”，和“何时”。这非常重要，因为由于高价值流量时间，渗透测试人员可能无法在某些时间进行渗透测试；他们也可能未经授权进行网络或托管在AWS环境中的Web应用程序的某些渗透测试区域。
- en: Before the target organization gives out the get-out-of-jail-free cards to the
    pentest team, there needs to be a clear understanding of the scope. If something
    in the range of the pentest needs to be added or removed, then it should be corrected
    and listed on the get-out-of-jail-free card.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 在目标组织向渗透测试团队提供免责卡之前，需要明确了解范围。如果需要添加或删除渗透测试范围内的内容，那么应该进行更正，并列在免责卡上。
- en: Potential damage
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 潜在损害
- en: 'This is a topic that many of us don''t like to discuss, or at the very least,
    feel very uneasy discussing: the potential that systems may be damaged or brought
    down during the pentest. This is especially challenging when asked for the pentest
    of a production or live system that would have massive revenue loss if it went
    down. The pentest team and the client organization must create an emergency response
    plan in the unfortunate case that an outage does occur. Additionally, there should
    be a workaround to bring up a test system that mimics the production environments.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我们许多人不喜欢讨论的话题，或者至少在讨论时感到非常不安：系统可能在渗透测试期间被损坏或关闭的可能性。当要求对生产或实时系统进行渗透测试时，如果系统崩溃将导致巨大的收入损失，这尤其具有挑战性。渗透测试团队和客户组织必须制定一项紧急响应计划，以防不幸发生故障。此外，应该有一种解决方案，可以启动一个模仿生产环境的测试系统。
- en: When pentesting AWS, we can advise our clients to create a separate private
    VPC that mimics the production environment and only allow access to the pentest
    team. Doing this allows the pentest team to test the systems in real time without
    causing any harm to the live system.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 在对AWS进行渗透测试时，我们可以建议我们的客户创建一个模仿生产环境的单独的私人VPC，并且只允许渗透测试团队访问。这样做可以让渗透测试团队实时测试系统，而不会对实时系统造成任何伤害。
- en: Understanding the data classifications
  id: totrans-85
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 了解数据分类
- en: We want to know what type of data is being stored in the environments during
    the pentest. If there is credit card data, social security numbers, and other
    sensitive data, then there needs to be a statement that illustrates that data
    may be seen during the pentest. Of course, if sensitive data is discovered in
    plain text when it should be encrypted, then the pentest team needs to notify
    their client immediately.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想知道在渗透测试期间存储在环境中的数据类型。如果有信用卡数据、社会安全号码和其他敏感数据，那么需要有一份说明，说明在渗透测试期间可能会看到数据。当然，如果发现明文存储的敏感数据应该加密，渗透测试团队需要立即通知他们的客户。
- en: We have learned quite a bit in this chapter about impactful attacks and also
    about legal issues. Now, let's discuss one more issue that we need to understand
    and look out for – stress testing.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们已经学到了很多关于有影响力的攻击，也了解了一些法律问题。现在，让我们讨论另一个问题，我们需要了解并注意 - 压力测试。
- en: Stress testing
  id: totrans-88
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 压力测试
- en: There are policies built around Amazon customers who plan on using some type
    of high-volume testing to test against the reliability and durability of their
    systems, networks, and products. In this case, often customers may want to ensure
    that web servers hosted on an EC2 instance can withstand large amounts of traffic.
    Stress testing, which can also at times be called load testing, or gameplay testing,
    can also ensure that if traffic becomes too much for the web server, the traffic
    is then redirected by a load balancer. For a high-level view of load balancing,
    please refer to *Figure 11.4*.
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 围绕着亚马逊客户计划使用某种类型的高容量测试来测试其系统、网络和产品的可靠性和耐久性建立了政策。在这种情况下，客户通常希望确保托管在EC2实例上的Web服务器能够承受大量的流量。压力测试，有时也称为负载测试或游戏测试，还可以确保如果流量对Web服务器造成了太大的压力，流量将被负载均衡器重定向。有关负载均衡的高级视图，请参阅*图11.4*。
- en: Why stress test?
  id: totrans-90
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为什么要进行压力测试？
- en: As mentioned, we execute a stress test to ensure that the target environment
    can take on the high amount of traffic that may be expected while the system is
    in production.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，我们进行压力测试是为了确保目标环境能够承受在系统生产期间可能预期的大量流量。
- en: Important note
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 重要说明
- en: A production server will typically be accessible on the web and will ensure
    large amounts of traffic from legitimate and non-legitimate sources.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 生产服务器通常可以在网络上访问，并确保来自合法和非法来源的大量流量。
- en: Load testing, or stress testing, essentially acts as an assurance policy and
    gives you peace of mind to understand your AWS environment's availability – ensuring
    that your site or applications don't go down! If something, especially in production,
    were to go down, it could result in revenue loss, the loss of trust between the
    company and its customers, or the loss of employee-to-company trust relationships.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 负载测试，或者压力测试，本质上是一种保证政策，让您放心了解您的AWS环境的可用性 - 确保您的网站或应用程序不会崩溃！如果某些东西，特别是在生产中，出现故障，可能会导致收入损失，公司与客户之间的信任丧失，或者员工与公司之间的信任关系丧失。
- en: Now that we understand the impacts of stress testing – and in some sense, we
    also understand the implications of stress testing if not applied – let's discuss
    how to get stress testing done on an AWS environment.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们了解了压力测试的影响 - 在某种意义上，我们也了解了如果不进行压力测试会有什么影响 - 让我们讨论如何在AWS环境中进行压力测试。
- en: Authorized stress testing
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 授权压力测试
- en: In order to be authorized to perform stress testing on your AWS environment,
    you need to submit an intake form to AWS. While most customer networks do not
    fall within the guidelines, it is essential to check rather than not – after all,
    not stress testing your environment could result in more significant issues later!
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 要获得在AWS环境中执行压力测试的授权，您需要向AWS提交一个接收表格。虽然大多数客户网络不在指导方针范围内，但检查是必不可少的 - 毕竟，不进行环境压力测试可能会导致更大的问题！
- en: While AWS does a wonderful job of supplying resources that prevent any issues
    related to the adverse effects of high-volume traffic, customers can send emails
    to AWS staff to determine whether their networks should be subject to a load test,
    and how much of a load should be applied to the test.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然AWS在提供资源方面做得很好，以防止与高流量相关的任何问题，但客户可以向AWS员工发送电子邮件，以确定他们的网络是否应该接受负载测试，以及应该对测试施加多少负载。
- en: If concerned, customers should send the query to `aws-security-simulated-event@amazon.com`.
    Once confirmation of the email is received, customers' concerns about their network
    will need to be filled out on an intake form and they must authorize AWS to evaluate
    their environment to analyze whether it needs to be stress-tested or not.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 如果有疑虑，客户应该将查询发送至`aws-security-simulated-event@amazon.com`。一旦确认收到电子邮件，客户对其网络的担忧将需要在一个接收表格上填写，并且他们必须授权AWS评估他们的环境，以分析是否需要进行压力测试。
- en: Consent for stress testing will be based on risk and the impact of the systems
    in question. It's advised that customers illustrate the effects that potential
    high-volume traffic may have on live systems. If stress testing is authorized,
    it is recommended that a backup site be ready to deploy in the event that the
    production system fails the load test. A production system failing a load test
    results in the system going offline and not being accessible by customers.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 压力测试的同意将基于风险和相关系统的影响。建议客户说明潜在的高流量可能对实时系统产生的影响。如果授权进行压力测试，建议备用站点准备就绪，以防生产系统未能通过负载测试。生产系统未能通过负载测试将导致系统下线，客户无法访问。
- en: Another great way to have a consistent backup is by having a development model
    or test model of the production system on the internal network. This replica of
    the live system can be used to test new features and as a target during an external
    and internal pentest, instead of targeting the production site. If a test system
    of the production site is not available, it is highly encouraged to have one!
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个保持一致备份的好方法是在内部网络上拥有生产系统的开发模型或测试模型。这个复制的实时系统可以用来测试新功能，并且可以在外部和内部渗透测试期间作为目标，而不是针对生产站点。如果生产站点的测试系统不可用，强烈建议拥有一个！
- en: Now that we understand more about stress testing and how we can use it to evaluate
    our own systems, let's start to wrap up this chapter and start moving forward
    to the next chapter.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们更了解压力测试以及如何使用它来评估我们自己的系统，让我们开始总结本章并继续前进到下一章。
- en: Summary
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: In this chapter, we discussed what to look out for during a pentest and learned
    more details about what DoS, DDoS, and flooding attacks are. As we learned, these
    attacks can be extremely impactful and are made against AWS policies. We also
    learned about avoiding legal issues and how to mitigate any potential legal issues
    that may come up during a pentest. We finished off the chapter by discussing stress
    testing and what AWS customers can do in order to understand whether their environments
    should be subject to a load balancing test or not.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们讨论了在渗透测试期间要注意的事项，并了解了DoS、DDoS和洪水攻击的更多细节。正如我们所了解的，这些攻击可能会产生极大影响，并违反AWS政策。我们还了解了如何避免法律问题以及如何减轻渗透测试期间可能出现的任何潜在法律问题。我们通过讨论压力测试以及AWS客户可以做些什么来了解他们的环境是否应该接受负载平衡测试来结束了本章。
- en: In the next, and final, chapter, we are going to explore some other projects
    that we can use to help strengthen our AWS methodology.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章，也是最后一章中，我们将探讨一些其他项目，可以帮助加强我们的AWS方法论。
- en: Further reading
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 进一步阅读
- en: 'AWS pentesting: [https://aws.amazon.com/security/penetration-testing/](https://aws.amazon.com/security/penetration-testing/)'
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: AWS渗透测试：[https://aws.amazon.com/security/penetration-testing/](https://aws.amazon.com/security/penetration-testing/)
- en: What is DDoS and DoS? [https://aws.amazon.com/shield/ddos-attack-protection/](https://aws.amazon.com/shield/ddos-attack-protection/)
  id: totrans-108
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 什么是DDoS和DoS？[https://aws.amazon.com/shield/ddos-attack-protection/](https://aws.amazon.com/shield/ddos-attack-protection/)
- en: 'Stress testing: [https://aws.amazon.com/ec2/testing/](https://aws.amazon.com/ec2/testing/)'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 压力测试：[https://aws.amazon.com/ec2/testing/](https://aws.amazon.com/ec2/testing/)

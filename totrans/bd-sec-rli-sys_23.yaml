- en: Chapter 17\. Crisis Management
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第17章。危机管理
- en: By Matt Linton
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 作者：Matt Linton
- en: with Nick Soda and Gary O’Connor‎
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 与Nick Soda和Gary O'Connor一起
- en: Incident response is critical for both reliability and security incidents. [Chapter
    14 of the SRE book](https://landing.google.com/sre/sre-book/chapters/managing-incidents/)
    and [Chapter 9 of the SRE workbook](https://landing.google.com/sre/workbook/chapters/incident-response/)
    explore incident response as it relates to reliability outages. We use the same
    methodology—the Incident Management at Google (IMAG) framework—to respond to security
    incidents.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 事件响应对于可靠性和安全事件都至关重要。《SRE书》的第14章和《SRE工作手册》的第9章探讨了与可靠性故障相关的事件响应。我们使用相同的方法——谷歌的事件管理（IMAG）框架——来应对安全事件。
- en: 'Security incidents are inevitable. A common maxim in the industry states that
    “There are only two types of companies: those that know they’ve been compromised,
    and those that don’t know.” The outcome of a security incident depends upon how
    well your organization prepares, and also how well you respond. To achieve a mature
    security posture, your organization needs to institute and practice an incident
    response (IR) capability, as discussed in the previous chapter.'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 安全事件是不可避免的。行业中有一句常见的格言是“只有两种公司：知道自己受到了侵害的和不知道自己受到了侵害的。”安全事件的结果取决于你的组织做好了多少准备，以及你的响应有多好。为了实现成熟的安全姿态，你的组织需要建立和实践事件响应（IR）能力，正如前一章所讨论的那样。
- en: In addition to the familiar pressures of ensuring that unauthorized parties
    can’t access your systems and that your data stays where it should, IR teams today
    face new and difficult challenges. As the security industry trends toward greater
    transparency^([1](ch17.html#ch17fn1)) and a need for increased openness with users,
    this expectation poses a unique challenge for any IR team accustomed to operating
    away from the spotlight of public attention. Additionally, regulations like the
    EU’s [General Data Protection Regulation (GDPR)](https://eugdpr.org) and service
    contracts with security-conscious customers continually push the boundaries of
    how quickly investigations must begin, progress, and complete. Today, it’s not
    unusual for a customer to ask for a notification of a potential security problem
    within 24 hours (or less) of initial detection.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 除了确保未经授权的人无法访问您的系统和数据保持在应有的位置之外，今天的IR团队还面临着新的和困难的挑战。随着安全行业朝着更大的透明度^([1](ch17.html#ch17fn1))和与用户更开放的需求趋势，这一期望对于习惯于在公众关注的聚光灯下运作的任何IR团队来说都是一个独特的挑战。此外，像欧盟的《通用数据保护条例（GDPR）》和与注重安全的客户的服务合同不断推动着调查必须开始、进行和完成的速度的边界。如今，客户要求在最初检测到潜在安全问题后的24小时（或更短时间内）内通知他们并不罕见。
- en: Incident notification has become a core feature of the security domain, alongside
    technological advances such as easy and ubiquitous use of cloud computing, widespread
    adoption of “bring your own device” (BYOD) policies in the workplace, and the
    Internet of Things (IoT). Such advances have created new challenges for IT and
    security staff—for example, limited control over and visibility into all of an
    organization’s assets.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 事件通知已成为安全领域的核心特性，与云计算的易用性和普及性、工作场所“自带设备”（BYOD）政策的广泛采用以及物联网（IoT）等技术进步并驾齐驱。这些进步为IT和安全人员带来了新的挑战，例如对组织所有资产的控制和可见性的限制。
- en: Is It a Crisis or Not?
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 这是危机吗？
- en: Not every incident is a crisis. In fact, if your organization is in good shape,
    relatively few incidents should turn into crises. Once an escalation occurs, a
    responder’s first step in assessing the escalation is *triage*—using the knowledge
    and information available to them to make educated and informed assumptions about
    the severity and potential consequences of the incident.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 并非每个事件都是危机。事实上，如果你的组织状况良好，相对较少的事件应该会演变成危机。一旦发生升级，响应者评估升级的第一步是*分诊*——利用他们掌握的知识和信息对事件的严重性和潜在后果进行合理和明智的假设。
- en: Triage is a well-established skill in the emergency medical community. An emergency
    medical technician (EMT) arriving on the scene of a vehicle accident will first
    make sure there are no immediate risks of further injury to anyone at the scene,
    and then perform triage. For example, if a bus has collided with a car, a few
    pieces of information are already logically available. The people in the car may
    have sustained serious injuries, because a collision with a heavy bus can inflict
    a great deal of damage. A bus can hold many passengers, so there may be multiple
    injuries to passengers. It’s unlikely that any dangerous chemicals are present,
    because neither vehicle would typically carry them. Within the first minute of
    arriving, the EMT knows that they’ll need to call for more ambulances, possibly
    alert a critical care unit, and call the fire department to free any trapped occupants
    from the smaller vehicle. They probably don’t need a hazardous materials cleanup
    crew.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: '分诊是急诊医疗界的一项成熟技能。一名急救医生（EMT）到达车祸现场时，首先要确保现场没有进一步伤害的立即风险，然后进行分诊。例如，如果一辆公共汽车与一辆小汽车相撞，已经可以逻辑推断出一些信息。小汽车上的人可能受了重伤，因为与重型公共汽车的碰撞可能会造成很大的伤害。公共汽车可以载有许多乘客，所以乘客可能会受伤。通常情况下，两辆车都不会携带危险化学品。在到达的第一分钟内，急救医生知道他们需要叫更多的救护车，可能要警报重症监护单位，并叫消防部门来解救小车上被困的人。他们可能不需要危险物质清理队。 '
- en: Your security response team should use these same assessment methods to triage
    incidents as they come in. As a first step, they must estimate the potential severity
    of the attack.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 你的安全响应团队应该使用相同的评估方法来对待不断发生的事件。作为第一步，他们必须估计攻击的潜在严重程度。
- en: Triaging the Incident
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 事件分诊
- en: 'When triaging, the engineer assigned to investigate must gather basic facts
    to help decide whether the escalation is one of the following:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在分诊时，负责调查的工程师必须收集基本事实，以帮助决定升级是否属于以下情况之一：
- en: An error (i.e., a false positive)
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个错误（即误报）
- en: An easily correctable problem (an opportunistic compromise, perhaps)
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个容易纠正的问题（可能是一次机会性的妥协）
- en: A complex and potentially damaging problem (such as a targeted compromise)
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 一个复杂且可能具有破坏性的问题（比如有针对性的妥协）
- en: They should be able to triage predictable problems, bugs, and other straightforward
    issues using predetermined processes. Larger and more complex issues, such as
    targeted attacks, will likely require an organized and managed response.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 他们应该能够使用预定的流程对可预测的问题、错误和其他简单问题进行分诊。更大更复杂的问题，比如有针对性的攻击，可能需要组织和管理的响应。
- en: 'Every team should have preplanned criteria to help determine what constitutes
    an incident. Ideally, they should identify what kinds of risks are severe versus
    acceptable in their environment before an incident happens. The response to an
    incident will depend on the type of environment where the incident happened, the
    state of the organization’s preventative controls, and the sophistication of its
    response program. Consider how three organizations might respond to the same threat—a
    ransomware attack:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 每个团队都应该有预先计划的标准，以帮助确定什么构成了一起事件。理想情况下，他们应该在事件发生之前确定在他们的环境中哪些风险是严重的，哪些是可以接受的。对事件的响应将取决于事件发生的环境类型，组织预防控制的状态以及其响应程序的复杂性。考虑三个组织如何应对相同的威胁——勒索软件攻击：
- en: '*Organization 1* has a mature security process and layered defenses, including
    a restriction that permits only cryptographically signed and approved software
    to execute. In this environment, it’s highly unlikely that well-known ransomware
    can infect a machine or spread throughout the network. If it does, the detection
    system raises an alert, and someone investigates. Because of the mature processes
    and layered defenses, a single engineer can handle the issue: they can check to
    make sure no suspicious activity has occurred beyond the attempted malware execution,
    and resolve the issue using a standard process. This scenario doesn’t require
    a crisis-style incident response effort.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*组织1*拥有成熟的安全流程和分层防御，包括只允许加密签名和批准的软件执行的限制。在这种环境中，众所周知的勒索软件几乎不可能感染机器或在整个网络中传播。如果确实发生，检测系统会发出警报，然后有人进行调查。由于成熟的流程和分层防御，一个工程师可以处理这个问题：他们可以检查是否发生了可疑活动，超出了尝试恶意软件执行，并使用标准流程解决问题。这种情况不需要危机式的事件响应努力。'
- en: '*Organization 2* has a sales department that hosts customer demos in a cloud
    environment, where people who want to learn about the organization’s software
    install and manage their test instances. The security team notices that these
    users tend to make security configuration mistakes that result in system compromises.
    So that these compromises don’t require manual intervention from a human responder,
    the security team establishes a mechanism to automatically wipe and replace compromised
    cloud test instances. In this case, a ransomware worm would also not require much
    forensics or incident response attention. Although Organization 2 doesn’t prevent
    the ransomware from executing (as in Organization 1’s case), Organization 2’s
    automated mitigation tools can contain the risk.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*组织2*的销售部门在云环境中举办客户演示，想要了解组织软件的人安装和管理他们的测试实例。安全团队注意到这些用户倾向于犯安全配置错误，导致系统受到威胁。为了不需要人工干预，安全团队建立了一个机制，自动清除并替换受损的云测试实例。在这种情况下，勒索软件蠕虫也不需要太多的取证或事件响应关注。虽然组织2没有阻止勒索软件的执行（如组织1的情况），但组织2的自动化缓解工具可以控制风险。'
- en: '*Organization 3* has fewer layered defenses and limited visibility into whether
    its systems are compromised. The organization is at much greater risk of the ransomware
    spreading across its network and may not be able to respond quickly. In this case,
    a large number of business-critical systems may be affected if the worm spreads,
    and the organization will be severely impacted, requiring significant technical
    resources to rebuild the compromised networks and systems. This worm presents
    a serious risk for Organization 3.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*组织3*的分层防御较少，对其系统是否受到威胁的可见性有限。该组织面临着勒索软件在其网络中传播的更大风险，可能无法快速做出响应。在这种情况下，如果蠕虫传播，可能会影响大量业务关键系统，并且组织将受到严重影响，需要大量技术资源来重建受损的网络和系统。这种蠕虫对组织3构成严重风险。'
- en: While all three organizations are responding to the same source of risk (a ransomware
    attack), the differences in their layered defenses and level of process maturity
    affect the potential severity and impact of the attack. While Organization 1 may
    need to simply initiate a playbook-driven response, Organization 3 may face a
    crisis that requires coordinated incident management. As the likelihood that an
    incident will pose a serious risk to the organization increases, so does the likelihood
    that it will require an organized response by many participants.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然这三个组织都在应对相同的风险来源（勒索软件攻击），但它们的分层防御和流程成熟度水平的差异影响了攻击的潜在严重性和影响。虽然组织1可能只需要启动一个流程驱动的响应，组织3可能面临需要协调的事件管理的危机。随着事件对组织构成严重风险的可能性增加，需要组织多个参与者进行有组织的响应的可能性也增加。
- en: 'Your team can perform some basic assessments to determine whether an escalation
    requires a standard playbook-driven approach or a crisis management approach.
    Ask yourself the following questions:'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 您的团队可以进行一些基本评估，以确定升级是否需要标准的流程驱动方法或危机管理方法。问问自己以下问题：
- en: What data do you store that might be accessible to someone on that system? What
    is the value or criticality of that data?
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您存储了哪些可能对系统上的某人可访问的数据？这些数据的价值或关键性是什么？
- en: What trust relationships does the potentially compromised system have with other
    systems?
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 潜在受损系统与其他系统之间存在什么信任关系？
- en: Are there compensating controls that an attacker would also have to penetrate
    (and that seem intact) in order to take advantage of their foothold?
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否有补偿控制，攻击者也必须突破（并且似乎完好无损）才能利用他们的立足点？
- en: Does the attack seem to be commodity opportunistic malware (e.g., Adware), or
    does it appear more advanced or targeted (e.g., a phishing campaign seemingly
    crafted with your organization in mind)?
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 攻击是否看起来是商品机会主义恶意软件（例如广告软件），还是看起来更先进或有针对性（例如看起来是为你的组织量身定制的网络钓鱼活动）？
- en: Think through all the relevant factors for your organization, and determine
    the highest likely level of organizational risk given those facts.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 仔细考虑你组织的所有相关因素，并根据这些事实确定组织风险的最高可能水平。
- en: Compromises Versus Bugs
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 妥协与漏洞
- en: IR teams have long been tasked with responding to suspected intrusions and compromises.
    But what about software and hardware bugs, a.k.a. security vulnerabilities? Do
    you treat a newly discovered security vulnerability in your systems as a compromise
    that has yet to be discovered?
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 长期以来，IR团队一直负责应对疑似入侵和妥协事件。但是对于软件和硬件漏洞，也就是安全漏洞呢？你会把系统中新发现的安全漏洞视为尚未被发现的妥协吗？
- en: Software bugs are inevitable, and you can plan for them (as explained in [Chapter 8](ch08.html#design_for_resilience)).
    Good defensive practices remove or limit the potential negative consequences of
    vulnerabilities before they begin.^([2](ch17.html#ch17fn2)) If you plan well and
    implement in-depth defenses with additional layers of security, you shouldn’t
    need to handle vulnerability remediation the same way you handle incidents. That
    said, it may be appropriate to manage complicated or large-impact vulnerabilities
    with incident response processes, which can help you organize and respond quickly.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 软件漏洞是不可避免的，你可以为它们制定计划（如[第8章](ch08.html#design_for_resilience)中所述）。良好的防御实践在漏洞开始之前消除或限制潜在的负面后果。^([2](ch17.html#ch17fn2))如果你计划良好并实施了深度防御和额外的安全层，你就不需要像处理事件那样处理漏洞修复。也就是说，可能需要使用事件响应流程来管理复杂或影响较大的漏洞，这可以帮助你组织并快速响应。
- en: At Google, we typically treat vulnerabilities that carry extreme risk as incidents.
    Even if a bug isn’t actively being exploited, a particularly severe one can still
    introduce extreme risk. If you’re involved in fixing the vulnerability before
    it’s publicly disclosed (these efforts are often called *coordinated vulnerability
    disclosures*, or CVDs), operational security and confidentiality concerns may
    warrant a heightened response . Alternatively, if you’re hurrying to patch systems
    after a public disclosure, securing systems that have complex interdependencies
    may require urgent effort, and it may be difficult and time-consuming to deploy
    fixes.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 在谷歌，我们通常将具有极端风险的漏洞视为事件。即使漏洞没有被积极利用，尤其严重的漏洞仍然可能引入极端风险。如果你在漏洞被公开披露之前参与修复（这些努力通常被称为*协调漏洞披露*或CVDs），操作安全和保密问题可能需要加强响应。另外，如果你在公开披露后匆忙修补系统，保护具有复杂相互依赖关系的系统可能需要紧急努力，部署修复可能会困难且耗时。
- en: Some examples of particularly risky vulnerabilities include Spectre and Meltdown
    (CVE-2017-5715 and 5753), glibc (CVE-2015-0235), Stagefright (CVE-2015-1538),
    Shellshock (CVE-2014-6271), and Heartbleed (CVE-2014-0160).
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 一些特别危险的漏洞示例包括Spectre和Meltdown（CVE-2017-5715和5753）、glibc（CVE-2015-0235）、Stagefright（CVE-2015-1538）、Shellshock（CVE-2014-6271）和Heartbleed（CVE-2014-0160）。
- en: Taking Command of Your Incident
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 掌握你的事件
- en: 'Now that we’ve discussed the process of triage and risk assessment, the next
    three sections assume a “big one” has happened: you’ve identified or suspect a
    targeted compromise, and you need to perform full-fledged incident response.'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经讨论了分类和风险评估的过程，接下来的三节假设“大事”已经发生：你已经确定或怀疑受到了有针对性的妥协，需要进行全面的事件响应。
- en: 'The First Step: Don’t Panic!'
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第一步：不要惊慌！
- en: Many responders associate a serious incident escalation with a rising sense
    of panic and an adrenaline rush. Emergency responders in the fire, rescue, and
    medical fields are warned in basic training not to run at the scene of an emergency.
    Not only does running risk making the problem worse by increasing the likelihood
    of an accident on the scene, it also instills a sense of panic in the responder
    and the public. In a similar fashion, during a security incident, the extra few
    seconds you gain by rushing are quickly eclipsed by the consequences of a failure
    to plan.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 许多应对者将严重事件升级与不断上升的恐慌感和肾上腺素飙升联系在一起。消防、救援和医疗领域的紧急应对人员在基础培训中被告知不要在紧急情况下奔跑。奔跑不仅会增加现场事故的可能性，使问题变得更糟，还会给应对者和公众灌输恐慌感。类似地，在安全事件中，匆忙行动所获得的额外几秒钟很快就会被计划失败的后果所掩盖。
- en: Although the SRE and security teams at Google perform incident management similarly,
    there is a difference between beginning a crisis management response for a security
    incident and for a reliability incident such as an outage. When an outage occurs,
    the on-call SRE prepares to step into action. Their goal is to quickly find the
    errors and fix them to restore the system to a good state. Most importantly, the
    system is not conscious of its actions and won’t resist being fixed.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管谷歌的SRE和安全团队执行事件管理的方式类似，但在开始安全事件的危机管理响应和可靠性事件（如故障）之间存在差异。当发生故障时，值班的SRE准备采取行动。他们的目标是快速找到错误并修复它们，以恢复系统到良好状态。最重要的是，系统并不知道自己的行为，并且不会抵制被修复。
- en: In a potential compromise, the attacker may be paying close attention to actions
    taken by the target organization and work against the responders as they try to
    fix things. It can be catastrophic to attempt to fix the system without first
    completing a full investigation. Because typical SRE work doesn’t carry that risk,
    an SRE’s usual response is to fix the system first and then document what they
    learned from the failure. For example, if an engineer submits a change list (CL)
    that breaks production, an SRE might take immediate action to revert the CL, making
    the problem go away. Once the problem is fixed, the SRE will begin investigating
    what happened. A security response instead requires the team to complete a full
    investigation into what happened prior to attempting to correct things.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 在潜在的妥协中，攻击者可能会密切关注目标组织采取的行动，并在响应者试图修复问题时对抗他们。在没有进行全面调查之前尝试修复系统可能是灾难性的。因为典型的SRE工作不具备这种风险，SRE通常的响应是先修复系统，然后记录他们从失败中学到的东西。例如，如果工程师提交了一个破坏生产环境的更改列表（CL），SRE可能会立即采取行动来撤销CL，使问题消失。问题解决后，SRE将开始调查发生了什么。而安全响应则要求团队在尝试纠正事情之前完成对发生情况的全面调查。
- en: As a security incident responder, your first task is to take control of your
    emotions. Take the first five minutes of an escalation to breathe deeply, allow
    any feelings of panic to pass, remind yourself that you need a plan, and begin
    thinking through the next steps. While the desire to react immediately is strong,
    in practice, postmortems rarely report that a security response would have been
    more effective if staff had responded five minutes sooner. It’s more likely that
    some additional planning up front will add greater value.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 作为安全事件响应者，您的第一个任务是控制自己的情绪。在升级的前五分钟内，深呼吸，让任何恐慌的感觉过去，提醒自己需要一个计划，并开始考虑下一步。虽然立即做出反应的愿望很强烈，但实际上，事后分析很少报告说，如果员工早五分钟做出反应，安全响应就会更有效。更有可能的是，提前进行一些额外的规划将增加更大的价值。
- en: Beginning Your Response
  id: totrans-40
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 开始您的响应
- en: At Google, once an engineer decides that the issue they’re facing is an Incident,
    we follow a standard process. That process, called Incident Management at Google,
    is fully described in [Chapter 9 of the SRE workbook](https://landing.google.com/sre/workbook/chapters/incident-response/),
    along with case studies of outages and events where we’ve applied this protocol.
    This section describes how you can use IMAG as a standard framework to manage
    a security compromise.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 在谷歌，一旦工程师确定他们面临的问题是一个事件，我们就会遵循一个标准流程。这个流程称为谷歌的事件管理，在[SRE工作手册的第9章](https://landing.google.com/sre/workbook/chapters/incident-response/)中有详细描述，以及我们应用该协议的故障和事件的案例研究。本节描述了如何使用IMAG作为标准框架来管理安全妥协。
- en: 'First, a quick refresher: as mentioned in the previous chapter, IMAG is based
    on a formal process called the [Incident Command System (ICS)](https://oreil.ly/4cLxY),
    which is used by fire, rescue, and police agencies around the world. Like ICS,
    IMAG is a flexible response framework that is lightweight enough to manage small
    incidents, but capable of expanding to encompass large and wide-ranging issues.
    Our IMAG program is tasked with formalizing processes to ensure maximum success
    in three key areas of incident handling: command, control, and communications.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，快速回顾一下：如前一章所述，IMAG基于一种称为[事件指挥系统（ICS）](https://oreil.ly/4cLxY)的正式流程，该流程被全球的消防、救援和警察机构使用。像ICS一样，IMAG是一个灵活的响应框架，足够轻便以管理小事件，但又能够扩展到包括大规模和广泛的问题。我们的IMAG计划旨在规范流程，以确保在事件处理的三个关键领域（指挥、控制和通信）取得最大成功。
- en: 'The first step in managing an incident is to take *command*. In IMAG, we do
    this by issuing a declaration: “Our team is declaring an incident involving *X*,
    and I am the incident commander (IC).” Explicitly saying “this is an incident”
    may seem simple and perhaps unnecessary, but being explicit in order to avoid
    misunderstandings is a core principle of both command and communications. Beginning
    your incident with a declaration is the first step in aligning everyone’s expectations.
    Incidents are complex and unusual, involve high amounts of tension, and happen
    at high speed. Those involved need to focus. Executives should be notified that
    teams might ignore or bypass normal processes until the incident is contained.'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 管理事件的第一步是*指挥*。在IMAG中，我们通过发布声明来做到这一点：“我们的团队宣布涉及*X*的事件，我是事件指挥官（IC）。”明确地说“这是一个事件”可能看起来简单，甚至可能是不必要的，但为了避免误解，明确是指挥和通信的核心原则。以声明开始您的事件是对齐每个人期望的第一步。事件复杂而不寻常，涉及高度紧张，并且发生速度很快。参与其中的人需要专注。高管应该被通知，团队可能会忽略或绕过正常流程，直到事件得到控制。
- en: After a responder takes command and becomes the IC, their job is to keep *control*
    of the incident. The IC directs the response and ensures people are moving forward
    toward specific goals at all times, so that the chaos and uncertainty around a
    crisis doesn’t throw teams off track. In order to maintain control, the IC and
    their leads must constantly maintain excellent *communications* with everyone
    involved.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在响应者接管并成为IC之后，他们的工作是保持对事件的*控制*。IC指挥响应，并确保人们始终朝着特定目标前进，以便危机中的混乱和不确定性不会使团队偏离轨道。为了保持控制，IC和他们的领导必须与所有参与者保持卓越的*通信*。
- en: Google uses IMAG as a general-purpose response framework for all sorts of incidents.
    All on-call engineers (ideally) are trained in the same set of fundamentals and
    taught how to use them to scale and professionally manage a response. While the
    focus of SRE and security teams may differ, ultimately, having the same framework
    for response enables both groups to seamlessly interoperate under stress, when
    working with unfamiliar teams may be at its most difficult.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 谷歌使用IMAG作为各种事件的通用响应框架。所有值班工程师（理想情况下）都接受相同基本知识的培训，并学习如何使用它们来扩展和专业地管理响应。虽然SRE和安全团队的重点可能不同，但最终，拥有相同的响应框架使这两个团队能够在压力下无缝合作，当与陌生团队合作可能最困难时。
- en: Establishing Your Incident Team
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 建立您的事件团队
- en: Under the IMAG model, once an Incident is declared, the person declaring the
    incident either becomes the incident commander or selects an IC from among the
    other available staff. Regardless of which route you take, make this assignment
    explicit in order to avoid misunderstandings among responders. The person designated
    the IC must also explicitly acknowledge that they accept the assignment.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 根据IMAG模型，一旦宣布发生事故，宣布事故的人要么成为事故指挥官，要么从其他可用的工作人员中选择一个IC。无论选择哪种路线，都要明确指定这项任务，以避免响应者之间的误解。被指定为IC的人也必须明确承认他们接受了这项任务。
- en: Next, the IC will assess what actions need to be taken immediately, and who
    can fill those roles. You’ll likely need some skilled engineers to initiate the
    investigation. Large organizations may have a dedicated security team; very large
    organizations might even have a dedicated incident response team. A small organization
    may have one dedicated security person, or someone who handles security part time
    alongside other operational responsibilities.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，IC将评估需要立即采取的行动，以及谁可以担任这些角色。您可能需要一些熟练的工程师来启动调查。大型组织可能会有一个专门的安全团队；非常大型的组织甚至可能会有一个专门的事件响应团队。小型组织可能会有一个专门的安全人员，或者有人在其他运营责任之外兼职处理安全事务。
- en: 'Regardless of the size or makeup of the organization, the IC should locate
    staff who know the potentially affected systems well and deputize these individuals
    into an incident response team. If the incident grows larger and requires more
    staff, it’s helpful to assign a few leaders to head up certain aspects of the
    investigation. Nearly every incident needs an *operations lead* (OL): the tactical
    counterpart and partner to the IC. While the IC focuses on setting the strategic
    goals needed to make progress on the incident response, the OL focuses on meeting
    those goals and determining how to do so. Most of the technical staff performing
    investigations, fixing and patching systems, and so on should report to the OL.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 无论组织的规模或构成如何，IC都应该找到熟悉潜在受影响系统的员工，并将这些人员委派为事件响应团队。如果事件规模扩大并需要更多人员，最好指定一些领导人负责调查的某些方面。几乎每个事件都需要一个*运营负责人*（OL）：战术上的对应和IC的合作伙伴。虽然IC专注于制定实现事件响应进展所需的战略目标，OL专注于实现这些目标并确定如何实现。大多数执行调查、修复和打补丁系统等技术人员应该向OL汇报。
- en: 'Some other lead roles you may need to fill include the following:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能需要填补的其他主要角色包括以下内容：
- en: Management liaison
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 管理联络人
- en: You may need someone to make tough calls on the spot. Who from your organization
    can decide to shut down a revenue-generating service if necessary? Who can decide
    to send staff home or revoke the credentials of other engineers?
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 您可能需要有人立即做出艰难的决定。您的组织中谁可以决定必要时关闭一个产生收入的服务？谁可以决定让员工回家或撤销其他工程师的凭证？
- en: Legal lead
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 法律负责人
- en: Your incident may raise legal questions that you’ll need help answering. Do
    your employees have an enhanced expectation of privacy? For example, if you think
    someone downloaded malware via their web browser, do you need extra permissions
    to examine their browser history? What if you think they downloaded malware via
    their personal browser profile?
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 您的事件可能会引发您需要帮助回答的法律问题。您的员工是否有增强的隐私期望？例如，如果您认为有人通过其网络浏览器下载了恶意软件，您是否需要额外的权限来检查他们的浏览器历史记录？如果您认为他们通过个人浏览器配置文件下载了恶意软件怎么办？
- en: Communications lead
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 沟通负责人
- en: Depending on the nature of the incident, you may need to communicate with your
    customers, regulators, etc. A professional who is skilled at communicating could
    be a vital addition to your response team.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 根据事件的性质，您可能需要与客户、监管机构等进行沟通。擅长沟通的专业人员可能是您响应团队的重要补充。
- en: 'DEEP DIVE: Operational Security'
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 深入探讨：运营安全
- en: In the context of crisis management, *operational security (OpSec)* refers to
    the practice of keeping your response activity secret. Whether you are working
    on a suspected compromise, an insider abuse investigation, or a dangerous vulnerability
    whose existence could lead to widespread exploitation if publicized, you’ll likely
    have information that you need to keep secret, at least for a limited amount of
    time. We strongly recommend that you establish an OpSec plan today—before you
    ever have an incident—so that you don’t have to come up with this plan in a rush
    at the last minute. Once a secret is lost, it’s hard to regain.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 在危机管理的背景下，*运营安全（OpSec）*指的是保持响应活动秘密的做法。无论您是在怀疑妥协、内部滥用调查还是危险漏洞的工作，如果公开存在可能导致广泛利用的危险漏洞，您可能会有需要保密的信息，至少在有限的时间内。我们强烈建议您今天就建立一个OpSec计划——在您遇到事件之前——这样您就不必在最后一分钟匆忙制定计划。一旦秘密泄露，就很难重新获得。
- en: The IC is ultimately responsible for ensuring that rules around confidentiality
    are set, communicated, and followed. Every team member asked to work on an investigation
    should be briefed on what to expect. You may have specific rules for how to handle
    data, or expectations around which communication channels to use. For example,
    if you suspect your email server is within scope of a breach, you might prohibit
    employees from emailing one another about the breach in case an attacker can see
    those conversations.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: IC最终负责确保保密规则得到制定、传达和遵守。要求参与调查的每个团队成员都应该接受简要介绍。您可能有特定的数据处理规则，或者对使用哪些通信渠道有期望。例如，如果您怀疑您的电子邮件服务器在违规范围内，您可能会禁止员工之间就违规进行电子邮件交流，以防攻击者能够看到这些对话。
- en: As a best practice, we recommend that your IC document specific guidance for
    each incident response team member. Each team member should review and acknowledge
    these guidelines before starting work on the incident. If you don’t clearly communicate
    confidentiality rules to all relevant parties, you risk an information leak or
    premature disclosure.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 作为最佳实践，我们建议您的IC为每个事件响应团队成员制定具体的指导。每个团队成员在开始处理事件之前应该审查并确认这些指导。如果您没有清楚地向所有相关方传达保密规则，您就有可能发生信息泄漏或过早披露。
- en: In addition to protecting the response activity from your attacker, a good OpSec
    plan addresses how the response can proceed without further exposing the organization.
    Consider an attacker who compromises one of your employee’s accounts and is trying
    to steal other passwords from memory on a server. They’d be delighted if a system
    administrator logged into the affected machine with administrative credentials
    during their investigation. Plan ahead for how you’ll access data and machines
    without providing your attacker additional leverage. One way to accomplish this
    is to deploy remote forensic agents to all your systems in advance. These software
    packages maintain an access path for authorized responders from your company to
    obtain forensic artifacts without risking their own accounts by logging into the
    system.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 除了保护响应活动免受攻击者的影响外，一个良好的操作安全性计划还解决了如何在不进一步暴露组织的情况下进行响应。考虑一下，一个攻击者入侵了您公司员工的帐户，并试图从服务器的内存中窃取其他密码。如果在调查期间系统管理员使用管理凭据登录受影响的机器，攻击者会很高兴。提前计划如何在不给攻击者提供额外杠杆的情况下访问数据和机器是很重要的。一种方法是提前部署远程取证代理到所有系统。这些软件包可以为授权的响应者提供一条访问路径，让他们可以在不通过登录系统的方式冒风险获取取证物证。
- en: The consequences of cluing in an attacker that you’ve discovered their attack
    can be high. A determined attacker who wants to persist beyond your investigation
    may go quiet. This deprives you of valuable insight into the extent of their compromise
    and can cause you to miss one (or more) of their footholds. And an attacker who
    has accomplished their objective and does not want to stay quiet may respond to
    your discovery by destroying as much of your organization as they can on their
    way out the door!
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 向攻击者透露您已发现他们的攻击的后果可能很严重。一个决心要在您的调查之外持续存在的攻击者可能会保持安静。这会使您失去对他们妥协程度的宝贵洞察，并可能导致您错过他们的一个（或多个）立足点。而已经完成目标并且不想保持安静的攻击者可能会在发现您的行动后尽可能地摧毁您的组织！
- en: 'The following are some common OpSec mistakes:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一些常见的操作安全性错误：
- en: Communicating about or documenting the incident in a medium (such as email)
    that enables the attacker to monitor response activities.
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在可能让攻击者监视响应活动的媒介（如电子邮件）中传达或记录事件。
- en: Logging into compromised servers. This exposes potentially useful authentication
    credentials to the attacker.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 登录被入侵的服务器。这会向攻击者暴露潜在有用的身份验证凭据。
- en: Connecting to and interacting with the attacker’s “command and control” servers.
    For example, don’t try to access an attacker’s malware by downloading it from
    a machine you’re using to perform your investigation. Your actions will stand
    out in the attacker’s logs as unusual and could warn them of your investigation.
    Also, don’t perform port scanning or domain lookups for the attacker’s machines
    (a common mistake made by novice responders).
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 连接到并与攻击者的“命令和控制”服务器进行交互。例如，不要尝试通过从正在进行调查的机器下载来访问攻击者的恶意软件。您的行为将在攻击者的日志中显得异常，并可能警告他们您的调查。此外，不要对攻击者的机器进行端口扫描或域查找（这是新手响应者常犯的错误）。
- en: Locking accounts or changing passwords of affected users before your investigation
    is complete.
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在调查完成之前锁定受影响用户的帐户或更改密码。
- en: Taking systems offline before you understand the full scope of the attack.
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在了解攻击的全部范围之前将系统下线。
- en: Allowing your analysis workstations to be accessed with the same credentials
    an attacker may have stolen.
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 允许攻击者可能窃取的相同凭据访问您的分析工作站。
- en: 'Consider the following good practices in your OpSec response:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 在您的操作安全性响应中考虑以下良好的做法：
- en: Conduct meetings and discussions in person where possible. If you need to use
    chat or email, use new machines and infrastructure. For example, an organization
    facing a compromise of unknown extent might build a new temporary cloud-based
    environment and deploy machines that differ from its regular fleet (e.g., Chromebooks)
    for responders to communicate. Ideally, this tactic provides a clean environment
    to chat, document, and communicate outside of the attacker’s view.
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 尽可能进行面对面的会议和讨论。如果需要使用聊天或电子邮件，使用新的机器和基础设施。例如，面临未知程度的妥协的组织可能会建立一个新的临时基于云的环境，并部署与其常规设备不同的机器（例如，Chromebook）供响应者进行通信。理想情况下，这种策略提供了一个干净的环境，可以在攻击者的视线之外进行聊天、记录和交流。
- en: Wherever possible, ensure that your machines have remote agents or key-based
    access methods configured. This allows you to collect evidence without revealing
    login secrets.
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在可能的情况下，确保您的机器配置了远程代理或基于密钥的访问方法。这样可以在不泄露登录凭据的情况下收集证据。
- en: Be specific and explicit about confidentiality when asking people to help—they
    may not know particular information is supposed to be kept confidential unless
    you tell them.
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在请求他人帮助时，要明确和明确地说明保密性——除非您告诉他们，否则他们可能不知道特定信息应该保密。
- en: For each step of your investigation, consider the conclusions a shrewd attacker
    may draw from your actions. For example, an attacker who compromises a Windows
    server may notice a sudden rush of group policy tightening and conclude that they’ve
    been discovered.
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在调查的每个步骤中，考虑一个精明的攻击者可能从您的行动中得出的结论。例如，入侵Windows服务器的攻击者可能会注意到一波突然的组策略收紧，并得出他们已经被发现的结论。
- en: Trading Good OpSec for the Greater Good
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为了更大的利益而交换良好的操作安全性
- en: 'There’s one glaring exception to the general advice of keeping your incident
    response a secret: if you’re faced with an imminent and clearly identifiable risk.
    If you suspect a compromise to a system so critical that vital data, systems,
    or even lives may be at risk, extreme measures may be justified. In the case of
    a vulnerability or bug that’s being managed as an incident, sometimes that bug
    may be so easily exploited and so widely known (e.g., Shellshock^([3](ch17.html#ch17fn3)))
    that turning off or entirely disabling the system might be the best way to protect
    it. Doing so will, of course, make it obvious to your attacker and others that
    something is amiss.'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 在保持您的事件响应保密的一般建议中有一个明显的例外：如果您面临即将到来且明确可识别的风险。如果您怀疑对一个如此关键以至于重要数据、系统甚至生命可能处于危险之中的系统进行了妥协，可能会有正当理由采取极端措施。在处理作为事件的漏洞或错误的情况下，有时该漏洞可能如此容易被利用并且如此广为人知（例如，Shellshock^([3](ch17.html#ch17fn3)）），以至于关闭或完全禁用系统可能是保护它的最佳方式。这样做当然会让您的攻击者和其他人明显地意识到出现了问题。
- en: These sorts of big decisions and organizational tradeoffs aren’t likely to be
    solely made by the incident commander, except in extremely risky situations (e.g.,
    shutting off a control system for a power grid to prevent a catastrophe). Typically,
    executives within the organization make such calls. However, the IC is the resident
    expert in the room when those decisions are debated, and their advice and security
    expertise are critical. At the end of the day, much of an organization’s decision
    making in a crisis isn’t about making the *right* call; it’s about making the
    *best possible* call from among a range of suboptimal choices.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 这些重大决定和组织权衡不太可能仅由事件指挥官做出，除非在极端危险的情况下（例如，关闭电网控制系统以防止灾难）。通常，组织内的高管做出这样的决定。然而，当这些决定被辩论时，事件指挥官是房间里的专家，他们的建议和安全专业知识至关重要。在一天结束时，组织在危机中的许多决策并不是关于做出*正确*的决定；而是在一系列次优选择中做出*最佳可能*的选择。
- en: 'DEEP DIVE: The Investigative Process'
  id: totrans-78
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 深入探讨：调查过程
- en: Investigating a security compromise involves attempting to backtrack through
    each phase of the attack to reconstruct the attacker’s steps. Ideally, your IR
    team (composed of any engineers assigned to the job) will attempt to maintain
    a tight loop of effort among multiple tasks.^([4](ch17.html#ch17fn4)) This effort
    focuses on identifying all the affected parts of the organization and learning
    as much as possible about what happened.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 调查安全妥协涉及尝试通过攻击的每个阶段来追溯攻击者的步骤。理想情况下，您的IR团队（由分配到该工作的任何工程师组成）将尝试在多个任务之间保持紧密的努力循环。^([4](ch17.html#ch17fn4))
    这一努力侧重于确定组织的所有受影响部分，并尽可能多地了解发生了什么事情。
- en: '*Digital forensics* refers to the process of figuring out all of the actions
    an attacker may have taken on a device. A forensic analyst (the engineer performing
    forensics—ideally, someone with special training and experience) analyzes all
    the parts of the system, including available logs, to try to determine what happened.
    The analyst may perform some or all of the following investigative steps:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '*数字取证*是指确定攻击者可能在设备上采取的所有行动的过程。取证分析师（进行取证的工程师，最好是经过专门培训和经验的人）分析系统的所有部分，包括可用的日志，以确定发生了什么事情。分析师可能会执行以下一些或所有的调查步骤：'
- en: Forensic imaging
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 取证成像
- en: Making a secure read-only copy (and checksum) of any data storage devices attached
    to a compromised system. This preserves the data in a known state at the exact
    time the copy is taken, without accidentally overwriting or damaging the original
    disk. Court proceedings often need forensic images of original disks as evidence.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 制作与受损系统连接的任何数据存储设备的安全只读副本（和校验和）。这样可以在副本被拍摄时将数据保留在已知状态，而不会意外覆盖或损坏原始磁盘。法庭诉讼通常需要原始磁盘的取证图像作为证据。
- en: Memory imaging
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 内存成像
- en: Making a copy of a system’s memory (or in some cases, the memory of a running
    binary). Memory can contain many pieces of digital evidence that may be useful
    during an investigation—for example, process trees, executables that were running,
    and even passwords to files that attackers may have encrypted.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 制作系统内存的副本（或在某些情况下，运行二进制文件的内存）。内存可能包含许多数字证据，这些证据在调查过程中可能会有用，例如进程树、正在运行的可执行文件，甚至攻击者可能已加密的文件密码。
- en: File carving
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 文件刻录
- en: Extracting a disk’s contents to see if you can recover certain file types, especially
    those that may have been deleted—for example, logs the attacker tried to delete.
    Some operating systems don’t zero the contents of files when they’re deleted.
    Instead, they only unlink the filename and mark the disk area as free for later
    reuse. As a result, you may be able to recover data an attacker attempted to remove.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 提取磁盘内容，以查看是否可以恢复某些文件类型，特别是可能已被删除的文件，例如攻击者试图删除的日志。一些操作系统在删除文件时不会将文件内容清零。相反，它们只会取消文件名的链接，并将磁盘区域标记为以后重用。因此，您可能能够恢复攻击者试图删除的数据。
- en: Log analysis
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 日志分析
- en: Investigating events relating to the system that appear in logs, whether on
    the system itself or from other sources. Network logs may show who talked to the
    system and when; logs from other servers and desktops may show other activities.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 调查与日志中出现的与系统相关的事件，无论是在系统本身还是来自其他来源。网络日志可能显示谁何时与系统交谈；来自其他服务器和台式机的日志可能显示其他活动。
- en: Malware analysis
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 恶意软件分析
- en: Performing analysis on tools used by attackers to determine what those tools
    do, how they work, and what systems the tools might communicate with. The data
    from this analysis is usually fed back to teams doing forensic and detection work
    to provide better insight about potential indications that a system has been compromised.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 对攻击者使用的工具进行分析，以确定这些工具的功能、工作原理以及这些工具可能与哪些系统进行通信。此分析的数据通常反馈给进行取证和检测工作的团队，以提供有关系统可能已被入侵的潜在迹象的更好见解。
- en: In digital forensics, the relationships between events are as important as the
    events themselves.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 在数字取证中，事件之间的关系与事件本身一样重要。
- en: Much of the work a forensic analyst does to obtain artifacts contributes to
    the goal of building a *forensic timeline*.^([5](ch17.html#ch17fn5)) By collecting
    a chronologically ordered list of events, an analyst can determine correlation
    and causation of attacker activity, proving *why* these events happened.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: Sharding the investigation
  id: totrans-93
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'If you have enough personnel available to staff multiple efforts simultaneously
    (see [“Parallelizing the Incident”](#parallelizing_the_incident)), consider splitting
    your effort into three tracks, each tasked with a major piece of the investigation.
    For example, your OL might separate their makeshift team into three groups:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: A *Forensics* group to investigate systems and identify which ones the attacker
    has touched.
  id: totrans-95
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A *Reversing* group to study suspicious binaries, determining the unique fingerprints
    that serve as indicators of compromise (IOCs).^([6](ch17.html#ch17fn6))
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A *Hunting* group to search all systems for those fingerprints. This group notifies
    the Forensics group any time they identify a suspect system.
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Figure 17-1](#the_relationship_between_investigative) shows the relationships
    between the groups. The OL is responsible for keeping a tight feedback loop between
    these teams.'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: '![The relationship between investigative groups](assets/bsrs_1701.png)'
  id: totrans-99
  prefs: []
  type: TYPE_IMG
- en: Figure 17-1\. The relationship between investigative groups
  id: totrans-100
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: 'Eventually, the rate at which you discover new leads will slow down. At this
    point, the IC decides it’s time to move on to remediation. Have you learned all
    there is to learn? Probably not. But you may have learned all you need to know
    to successfully remove the attacker and protect the data they’re after. It can
    be tough to determine where to draw this line because of all the unknowns involved.
    Making this decision is a lot like knowing when to stop microwaving a bag of popcorn:
    when the interval between pops noticeably increases, you should move along before
    the entire bag burns. Prior to remediating, a lot of planning and coordination
    needs to happen. [Chapter 18](ch18.html#oneeight_recovery_and_aftermath) covers
    this in much more detail.'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
- en: Keeping Control of the Incident
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once an incident is declared and your team members are assigned responsibilities,
    the IC’s job is to keep the effort running smoothly. This task involves predicting
    the needs of the response team, and addressing those needs before they become
    problems. To be effective, the IC should devote all of their time to controlling
    and managing the incident. If, as IC, you find yourself jumping in to check logs,
    performing quick forensics tasks, or otherwise involving yourself with operations,
    it’s time to step back and reassess your priorities. If no one is at the helm
    of the ship, it’s guaranteed to veer off course or even crash.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: Parallelizing the Incident
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Ideally, a practiced IR team can *parallelize* the incident by breaking down
    all the pieces of the incident response process and running them simultaneously,
    to the greatest extent possible. If you anticipate an unassigned task or a piece
    of information you’ll need during the incident lifecycle, assign someone to complete
    the task or prepare for the work. For example, you might not yet be ready to share
    your forensic findings with law enforcement or a third-party firm that will aid
    in your investigation, but if you plan to share your findings in the future, your
    raw investigation notes won’t be helpful. Assign someone to prepare a redacted
    and shareable list of indicators as your investigation proceeds.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: It may seem counterintuitive to begin preparations to clean up your environment
    during the early stages of your forensic investigation, but if you have available
    staff, it’s a great time to assign this task. IMAG allows you to create custom
    roles at any time, so you assign someone the *remediation lead* (RL) role at any
    point during the incident. The RL can begin studying the areas of confirmed compromise
    as the ops team discovers them. Armed with this information, the RL can create
    a plan to clean up and fix these compromised areas later. When the ops team completes
    their investigation, the IC will already have the cleanup plan in place. At this
    point, rather than deciding next steps on the spot, they can initiate the next
    phase of work. Similarly, if you have the staff available, it’s never too early
    to assign someone to begin the postmortem.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: 'To borrow a programming construct, an IC’s role in a large incident looks like
    a set of steps through a `while` loop:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The *OODA loop* is another relevant framework for incident-related decision
    making: a pattern where the responder should *observe*, *orient*, *decide*, and
    *act*. This is a helpful mnemonic for reminding yourself to consider new information
    carefully, think about how it applies to the big picture for your incident, decide
    on a course of action with intent, and only then take action.'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: Handovers
  id: totrans-110
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: No human can work nonstop on a single problem for long periods of time without
    experiencing problems. Most of the time, the crises we encounter take time to
    resolve. Smoothly passing work back and forth between responders is a must and
    helps to build a culture of security and reliability (see [Chapter 21](ch21.html#twoone_building_a_culture_of_security_a)).
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: Fighting a large forest fire is physically and emotionally demanding and can
    take days, weeks, or even months. To fight such a fire, the California Department
    of Forestry and Fire Protection breaks it into “areas” and assigns an incident
    commander to each one. The IC for a given area establishes a long-term objective
    for their area and short-term goals to progress toward the objective. They split
    their available resources into shifts so that while one team works, another team
    rests and is ready to relieve the first team when they’re exhausted.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
- en: When the crews working on the fire are nearing their limits, the IC collects
    status updates from all the team leads and assigns new team leads to replace them.
    The IC then briefs the new team leads on the overall objective, their assignment,
    specific goals they are expected to accomplish, resources available, safety hazards,
    and any other relevant information. Then the new team leads and their staff take
    over from the previous shift’s staff. Each incoming lead communicates quickly
    with the outgoing lead to ensure they didn’t miss any relevant facts. The fatigued
    crew can now rest while the firefighting continues.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
- en: Security incident response is not as physically demanding as fighting fires,
    but your team will experience similar emotional and stress-related exhaustion.
    It’s crucial to have a plan to hand their work off to others when necessary. Eventually,
    a tired responder will start to make mistakes. If worked hard enough for long
    enough, your team will make more mistakes than they are correcting—a phenomenon
    often referred to as the [*law of diminishing returns*](https://oreil.ly/_1_iU).
    Staff fatigue isn’t just a matter of treating your team kindly; fatigue can cripple
    your response through errors and low morale. To avoid overwork, we recommend limiting
    shifts (including IC shifts) to no more than 12 continuous hours.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
- en: If you have a large staff and want to accelerate your response, consider splitting
    your response team into two smaller groups. These teams can staff your response
    24 hours a day until the incident is resolved. If you don’t have a large staff,
    you might need to accept the risk of a slower response so your staff can go home
    and rest. While small teams can work extra-long hours in “hero mode,” this mode
    is unsustainable and yields lower-quality results. We recommend that you use hero
    mode very sparingly.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: Consider an organization with teams in the Americas, Asia-Pacific, and European
    regions. This kind of organization can staff a “follow-the-sun” rotation so that
    fresh responders continually cycle on the incident according to a schedule, as
    depicted in [Figure 17-2](#follow_the_sun_rotation). A smaller organization might
    have a similar schedule, but with fewer locations and more time between rotations,
    or perhaps a single location with half the operations staff working night shifts
    to keep the response going while the others rest.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: '![Follow-the-sun rotation](assets/bsrs_1702.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
- en: Figure 17-2\. Follow-the-sun rotation
  id: totrans-118
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: The IC should prepare for an incident handover ahead of time. Handovers include
    updating tracking documentation, evidence notes and files, and any other written
    records kept during the shift. Arrange handover logistics, time, and method of
    communication in advance. The meeting should begin with a summary of the current
    incident state and direction of the investigation. You should also include a formal
    handover from each lead (ops, comms, etc.) to their corresponding replacement.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: The information you should communicate to the incoming team depends on the incident.
    At Google, we’ve found it consistently helpful for the IC of the outgoing team
    to ask themselves, “If I weren’t handing this investigation over to you, what
    would I spend the next 12 hours working on?” The IC of the incoming relief team
    should have an answer to this question before the handover meeting ends.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, a handover meeting agenda might look something like this:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
- en: '[Outgoing IC] Delegate one person to take notes, preferably from the incoming
    team.'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Outgoing IC] Summarize current status.'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Outgoing IC] Outline the tasks the IC would do over the next 12 hours if they
    weren’t handing off the incident.'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[All attendees] Discuss the issue.'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Incoming IC] Outline the tasks you expect to handle during the next 12 hours.'
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Incoming IC] Establish time(s) of next meeting(s).'
  id: totrans-127
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Morale
  id: totrans-128
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: During any major incident, the IC needs to maintain team morale. This responsibility
    is often overlooked, but is critical. Incidents can be stressful, and each engineer
    will respond differently to these high-pressure situations. Some rise to the challenge
    and participate enthusiastically, while others find the combination of intense
    effort and ambiguity deeply frustrating, and would like nothing more than to leave
    the scene of the incident and go home.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
- en: 'As an IC, don’t forget that motivating, encouraging, and keeping track of the
    general emotional state of your team are key factors in achieving a positive incident
    outcome. Here are some tips for maintaining morale in the midst of a crisis:'
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: Eat
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: As your response team pushes itself to make progress, hunger will invariably
    strike. This decreases the team’s effectiveness and can put people on edge. Plan
    in advance to take breaks and bring in food whenever possible. This helps keep
    the team happy and focused when you need them to be.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: Sleep
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: The law of diminishing returns applies to humans, too. Your staff will become
    less effective over time as exhaustion sets in and each member passes their own
    peak fatigue point. After this point, it’s possible that continued work will result
    in more mistakes than progress, setting the incident response back. Keep watch
    for fatigue in your responders, and be sure that they are allowed rest periods
    as needed. Leaders may even need to intervene to ensure that people who don’t
    recognize their own need for rest still take breaks.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
- en: Destress
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: When the opportunity presents itself—for example, if the team is waiting for
    a file array to finish rebuilding and can’t make parallel progress—gather everyone
    together for a destressing activity. Several years ago, during a particularly
    large and lengthy incident at Google, the response team took a one-hour break
    to smash a failed hard drive using a hammer and some liquid nitrogen. Years later,
    the team involved recalls that activity as a highlight of the response.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
- en: Watch for burnout
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
- en: As an IC, you should actively watch for signs of burnout in your team (and yourself).
    Is a critical engineer starting to become more cynical and defeatist? Are staff
    expressing fears that the challenge is unwinnable? This may be the first time
    they’ve had to handle a major incident, and they may have a lot of fears. Talk
    with them frankly and make sure they understand your expectations and how they
    can meet those expectations. If a team member needs a break and you have someone
    to replace them, offer a relief period.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
- en: Lead by example
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: A realistic but positive outlook openly expressed by a leader goes a long way
    toward setting your team’s expectations around their success. This kind of outlook
    encourages the team and makes them feel like they can achieve their goal. Additionally,
    members of a response team may be skeptical that taking time for self-care (e.g.,
    eating and sleeping adequately) is truly encouraged until they see the IC or OL
    openly doing so as a best practice.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
- en: Communications
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Of all the technical issues involved in incident response, communication remains
    the most challenging. Even in the best of circumstances, effective communication
    with coworkers and others outside your immediate group can be difficult. When
    subjected to stress, tight deadlines, and the high stakes of a security incident,
    these difficulties can intensify and quickly lead to a delayed or missed response.
    Here are a few major communications challenges you might encounter, and tips for
    managing them.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-143
  prefs:
  - PREF_H6
  type: TYPE_NORMAL
- en: Many excellent books cover the topic of communications thoroughly. For a deeper
    understanding of communications, we recommend Nick Morgan’s *Can You Hear Me?*
    (Harvard Business Review Press, 2018) and Alan Alda’s *If I Understood You, Would
    I Have This Look on My Face?* (Random House, 2017).
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
- en: Misunderstandings
  id: totrans-145
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Misunderstandings between the responders will likely make up the bulk of your
    communication problems. People who are used to working together may make assumptions
    about things that haven’t been said. People who are not used to working together
    may use unfamiliar jargon, acronyms that mean different things to different teams,
    or assume a common frame of reference that isn’t actually common.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: For example, take the phrase “We can turn the service back on when the attack
    is mitigated.’’ To the product team, this may mean that as soon as the attacker’s
    tools are deleted, the system is safe to use. To the security team, this may mean
    that the system isn’t safe to use until a complete investigation has concluded
    that the attacker is no longer able to exist in, or return to, the environment.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
- en: When you find yourself handling an incident, as a rule of thumb, it’s helpful
    to always *be explicit and overcommunicate*. Explain what you mean when you ask
    for something or set an expectation, even if you think the other person ought
    to know what you mean. In the example from the previous paragraph, it couldn’t
    hurt to say, “We can turn the service back on when we are confident that all paths
    back in have been fixed, and that the attacker is no longer able to access our
    systems.” Keep in mind that the responsibility of communicating usually belongs
    to the communicator—only they can make sure the people they’re communicating with
    receive the intended message.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: Hedging
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Hedging is another common communication mistake. When people are expected to
    give advice in a stressful situation but aren’t feeling confident, they often
    tend to add qualifiers to their statements. Avoiding expressing certainty about
    an uncertain situation by saying something like “We’re pretty sure we found all
    the malware” might feel safer, but hedging often muddies the situation and leads
    to uncertainty among decision makers. Again, being explicit and overcommunicating
    is the best remedy here. If your IC asks if you’ve identified all the attacker’s
    tools, “We’re pretty sure” is a weak answer. It would be better to answer, “We
    are sure about our servers, NAS, email, and file shares, but aren’t feeling confident
    about our hosted systems because we have less log visibility there.”
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: Meetings
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To make progress on an incident, you’ll need to get people together to coordinate
    their efforts. Regular, rapid syncs with key players in the incident response
    are a particularly effective way to maintain control and visibility of everything
    that’s happening. The IC, the OL, a company attorney, and a few key executives
    might meet every two or four hours to make sure the team can quickly adapt to
    any new developments.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: We recommend aggressively limiting attendees of these meetings. If you have
    a room or videoconference full of people, and only a handful are speaking while
    the rest listen or check email, your invite list is too large. Ideally, the incident
    leads should attend these meetings while everyone else works on tasks that need
    to be completed. Once the meeting ends, the leads can update their respective
    teams.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
- en: 'While meetings are often a necessary part of working together, improperly managed
    meetings risk derailing your progress. We strongly recommend that an IC open every
    meeting with a set agenda they’ve planned in advance. This may seem like an obvious
    step, but it can be easy to forget during the adrenaline rush and stress of an
    ongoing incident. Here’s an example agenda used at Google for a security incident
    kickoff meeting:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '[IC] Delegate one person to take notes.'
  id: totrans-155
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] All attendees introduce themselves, starting with the IC:'
  id: totrans-156
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Name
  id: totrans-157
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Team
  id: totrans-158
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Role
  id: totrans-159
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] Rules of engagement:'
  id: totrans-160
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Do you need to take confidentiality into account?
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Are there specific operational security concerns to consider?
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Who owns making decisions? Who should be included in decision-making processes?
    Who should *not* be included?
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Let your lead know if you’re switching tasks/finished doing something.
  id: totrans-164
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] Describe current status: what problem are we solving?'
  id: totrans-165
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[All] Discuss the issue.'
  id: totrans-166
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] Summarize actions and owners.'
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] Ask the group:'
  id: totrans-168
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Are there any more resources we need?
  id: totrans-169
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Are there any other groups we need to involve?
  id: totrans-170
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What roadblocks are there?
  id: totrans-171
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] Establish time of next sync meeting and expected attendance:'
  id: totrans-172
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Who is required?
  id: totrans-173
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Who is optional?
  id: totrans-174
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'And here’s one for an in-progress sync meeting:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: '[IC] Delegate one person to take notes.'
  id: totrans-176
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC or ops lead] Summarize current status.'
  id: totrans-177
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] Receive updates from each attendee/thread of activity.'
  id: totrans-178
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] Discuss next steps.'
  id: totrans-179
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Ops lead] Assign tasks, and get each person to repeat what they think they’re
    going to do.'
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[IC] Establish time(s) of next meeting(s).'
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[Ops lead] Update action tracker.'
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In both example agendas, the IC assigns a note taker. Through experience, we’ve
    learned that a note taker is essential for keeping your investigation on track.
    Leads are busy dealing with all the issues that arise in the meeting and won’t
    have the bandwidth to take good notes. During an incident, you often forget items
    you *think* you’ll remember. These notes also become invaluable when writing your
    postmortem. Keep in mind that if the incident has any legal ramifications, you’ll
    want to consult with your legal team on the best way to manage this information.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: Keeping the Right People Informed with the Right Levels of Detail
  id: totrans-184
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Figuring out the right level of detail to communicate is a major challenge for
    incident communications. Multiple individuals at multiple levels will need to
    know *something* related to the incident, but for OpSec reasons, they likely cannot
    or should not know *all* the details. Be aware that employees who are only vaguely
    aware of the incident are likely to engage in gap-filling.^([7](ch17.html#ch17fn9))
    Rumors among employees can quickly become erroneous and damaging when relayed
    outside the organization.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
- en: 'A long-running investigation may involve frequent updates with different levels
    of detail to the following people:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
- en: Executives and senior leadership
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
- en: They should receive brief, succinct updates on progress, roadblocks, and potential
    consequences.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
- en: The IR team
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: This team requires up-to-date information about the investigation.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
- en: Organizational personnel *not* involved in the incident
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: Your organization may need to decide what to tell personnel. If you tell all
    staff about the incident, you may be able to solicit their assistance. On the
    other hand, these people may spread information further than you intended. If
    you don’t tell organizational personnel about an incident but they find out anyway,
    you may need to deal with the rumor mill.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: Customers
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: Customers may be legally entitled to be informed of the incident within a set
    period of time, or your organization may choose to voluntarily notify them. If
    a response involves shutting off services visible to customers, they may have
    questions and demand answers.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
- en: Legal/justice system participants
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: If you escalated the incident to law enforcement, they may have questions and
    may begin requesting information you didn’t originally intend to share.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
- en: 'To help manage all these demands without constantly distracting the IC, we
    recommend appointing a *communications lead* (CL). The core job of the CL is to
    stay informed about the incident as it unfolds and to prepare comms to the relevant
    stakeholders. The key responsibilities of the CL include the following:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: Working with sales, support, and other internal partner teams to answer any
    questions they may have.
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Preparing briefs for executives, legal, regulators, and others with oversight
    roles.
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Working with press and PR to ensure that people have the right information to
    make accurate and timely statements about the incident when necessary. Ensure
    that people outside of the response team don’t make conflicting statements.
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Keeping constant and careful watch on the spread of information about the incident,
    so the incident staff respect any “need to know” guidelines.
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The CL will want to consider reaching out to domain experts, external crisis
    communication consultants, or anyone else they need to help manage information
    related to the incident with minimal delay.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
- en: Putting It All Together
  id: totrans-203
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This section ties together the contents of this chapter by walking through a
    hypothetical response to a compromise that an organization of any size might encounter.
    Consider a scenario where an engineer discovers that a service account they don’t
    recognize has been added to a cloud project they haven’t seen before. At noon,
    they escalate their concerns to the security team. After a preliminary investigation,
    the security team determines that an engineer’s account has likely been compromised.
    Using the advice and best practices presented earlier, let’s walk through how
    you might respond to such a compromise from beginning to end.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: Triage
  id: totrans-205
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The first step in your response is to triage. Start with a worst-case assumption:
    the security team’s suspicions are correct that the engineer’s account is compromised.
    An attacker using privileged access to view sensitive internal information and/or
    user data would be a serious security breach, so you declare an incident.'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: Declaring an Incident
  id: totrans-207
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'As the incident commander, you notify the rest of the security team of the
    following:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: An incident has occurred.
  id: totrans-209
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You will be assuming the role of IC.
  id: totrans-210
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You’ll need additional support from the team to investigate.
  id: totrans-211
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Communications and Operational Security
  id: totrans-212
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Now that you’ve declared the incident, other people in the organization—executives,
    legal, etc.—need to know an incident is in progress. If the attacker compromised
    your organization’s infrastructure, emailing or chatting with these people may
    be risky. Follow operational security best practices. Suppose your contingency
    plan calls for using an organization credit card to register a business account
    in a cloud-based environment not associated with your organization, and to create
    accounts for each person involved in the incident. To create and connect to this
    environment, you use freshly rebuilt laptops not connected to your organization’s
    management infrastructure.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
- en: Using this new environment, you call your executives and key legal staff to
    advise them on how to obtain a secure laptop and a cloud account so they can participate
    via email and chats. Since all the current responders are local to the office,
    you use a nearby meeting room to discuss the particulars of the incident.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: Beginning the Incident
  id: totrans-215
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As the IC, you need to assign engineers to investigate, so you ask an engineer
    on the security team with forensics experience to be the operations lead. Your
    new OL starts their forensic investigation immediately and recruits other engineers
    as needed. They begin by collecting logs from the cloud environment, focusing
    on the time period when the service account credentials in question were added.
    After confirming that the credentials were added by the engineer’s account during
    a time period when the engineer was definitely out of the office, the forensics
    team concludes that the account has been compromised.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: The forensics team now pivots from investigating only the suspect account to
    investigating all other activities around the time the account was added. The
    team decides to collect all the system logs relating to the compromised account,
    as well as that engineer’s laptop and workstation. The team determines that this
    investigation could take a single analyst quite some time, so they decide to add
    more staff and distribute the effort.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
- en: Your organization doesn’t have a large security team, so you don’t have enough
    skilled forensic analysts to adequately distribute the forensic task. However,
    you do have system administrators who understand their systems well and who can
    help analyze logs. You decide to assign these sysadmins to the forensics team.
    Your OL contacts them via email with a request to “discuss a few things” over
    a phone call, and briefs them fully during that call. The OL asks the sysadmins
    to collect all logs related to the compromised account from any system in the
    organization, while the forensics team analyzes the laptop and desktop.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: By 5 p.m. it’s clear that the investigation is going to last much longer than
    your team can continue working. As the IC, you correctly anticipate that your
    team will become fatigued and start to make mistakes before they can resolve the
    incident, so you need to come up with a handover or continuity plan. You notify
    your team that they have four hours to complete as much analysis of the logs and
    hosts as possible. During this time, you keep leadership and legal up to date
    and check in with the OL to see if their team needs additional help.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
- en: 'At the 9 p.m. team sync, the OL reveals that their team has found the attacker’s
    initial entry point: a very well-crafted phishing email to the engineer, who was
    tricked into running a command that downloads the attacker’s backdoor and establishes
    a persistent remote connection.'
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
- en: Handover
  id: totrans-221
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: By the 9 p.m. team sync, many of the engineers working on the problem have been
    at work for 12 hours or longer. As a diligent IC, you know that continuing to
    work at this pace is risky, and that the incident will require a lot more effort.
    You decide to hand off some of the work. While your organization doesn’t have
    a full security team outside of the main San Francisco office, you have an engineering
    office in London with some senior staff.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: You tell your team to take the next hour to finish documenting their findings
    while you contact the London team. A senior engineer in the London office is appointed
    as the next IC. As the outgoing IC, you brief the replacement IC on everything
    you’ve learned so far. After receiving ownership rights on all the incident-related
    documentation and making sure that the London team understands the next step,
    the London IC acknowledges that they are in charge until 9:00 PST the next morning.
    The San Francisco team is relieved and sent home to rest. Overnight, the London
    team continues the investigation, focusing on analyzing the backdoor scripts and
    actions performed by the attacker.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
- en: Handing Back the Incident
  id: totrans-224
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: At 9:00 the next morning, the San Francisco and London teams hold a handover
    sync. Overnight, the London team made lots of progress. They determined that the
    script run on the compromised workstation installed a simple backdoor, enabling
    the attacker to log in from a remote machine and start looking around the system.
    Noticing that the engineer’s shell history included logins to cloud service accounts,
    the adversary took advantage of the saved credentials and added their own service
    account key to the list of administrative tokens.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: After doing so, they took no further action on the workstation. Instead, cloud
    service logs show that the attacker interacted directly with the service APIs.
    They uploaded a new machine image and launched dozens of copies of that virtual
    machine in a new cloud project. The London team hasn’t yet analyzed any of the
    running images, but they audited all credentials in all existing projects and
    confirmed that the malicious service account and API tokens they know about are
    the only credentials that can’t be verified as legitimate.
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
- en: With this update from the London team, you acknowledge the new information and
    confirm that you are taking over as the IC. Next, you distill the new information
    and provide a concise update to executive leaders and legal. You also brief your
    team on the new findings.
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
- en: 'Although you know that the attacker had administrative access to production
    services, you don’t yet know whether user data was at risk or affected. You give
    your forensics team a new high-priority task: look at all other actions the attacker
    may have taken against existing production machines.'
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
- en: Preparing Communications and Remediation
  id: totrans-229
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As your investigation proceeds, you decide that it’s time to parallelize a few
    more components of your incident response. If the attacker potentially accessed
    your organization’s user data, you may need to inform users. You also need to
    mitigate the attack. You choose a colleague who is a strong technical writer to
    be the communications lead (CL). You ask one of the system admins who isn’t working
    on forensics to become the remediation lead (RL).
  id: totrans-230
  prefs: []
  type: TYPE_NORMAL
- en: In collaboration with the organization’s attorney, the CL drafts a blog post
    that explains what happened and the potential customer impact. Although there
    are many blanks (such as “<*fill this in*> data was <*fill this in*>”), having
    the structure ready and approved ahead of time helps you to communicate your message
    much faster when you know the full details.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: Meanwhile, the RL makes a list of every resource the organization knows to have
    been affected by the attacker, along with proposals for how to clean up each resource.
    Even if you know that the engineer’s password wasn’t exposed in the initial phishing
    email, you’ll need to change their account credentials. To be on the safe side,
    you decide to guard against backdoors that you haven’t yet found but that may
    appear later. You make a copy of the engineer’s important data and then erase
    their home directory, creating a new one on a freshly installed workstation.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
- en: As your response progresses, your team learns that the attacker didn’t access
    any production data—to everyone’s great relief! The additional VMs the attacker
    launched appear to be a swarm of coin mining servers that mine digital currency
    and direct the funds to the attacker’s virtual wallet. Your RL notes that you
    can delete these machines, or you can snapshot and archive the machines if you
    wish to report the incident to law enforcement later on. You can also delete the
    project the machines were created in.
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
- en: Closure
  id: totrans-234
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Around mid-afternoon, your team has run out of leads. They’ve searched every
    resource the malicious API keys may have touched, built their mitigation document,
    and confirmed that the attacker didn’t touch any sensitive data. Fortunately,
    this was an opportunistic coin mining exercise and the attacker wasn’t interested
    in any of your data—just a lot of compute capability on someone else’s bill. Your
    team decides that it’s time to execute your remediation plan. After checking in
    with legal and leadership to ensure that the decision to close out the incident
    has their approval, you signal the team that it’s time to act.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
- en: Freed from their forensic tasks, the operations team now divides up the tasks
    from the remediation plan and completes them as quickly as possible, ensuring
    that the attacker is shut off quickly and completely. They then spend the rest
    of the afternoon writing down their observations for a postmortem. Finally, you
    (the IC) hold an outbrief, where everyone on the team has the opportunity to discuss
    how the incident went. You clearly communicate that the incident is closed and
    no longer requires an emergency response. Your last task before everyone goes
    home to rest is to brief the London team so they also know that the incident is
    completed.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Incident management, when scaled, becomes its own art that is distinct and separate
    from general project management and smaller incident response work. By focusing
    on processes, tools, and proper organizational structures, it’s possible to staff
    a team that can effectively respond to any crisis at the speed today’s market
    requires. Whether you’re a small organization whose engineers and core team become
    a temporary response team as needed, a giant-scale organization with response
    teams across the globe, or anything in between, you can apply the best practices
    described in this chapter to effectively and efficiently respond to a security
    compromise. Parallelizing your incident response and forensic work and professionally
    managing the team using ICS/IMAG will help you respond scalably and reliably to
    any incidents that arise.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: ^([1](ch17.html#ch17fn1-marker)) See, e.g., [Google’s Transparency Report](https://oreil.ly/vQNR3).
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
- en: '^([2](ch17.html#ch17fn2-marker)) In one of our design reviews at Google, an
    engineer suggested that “There are two kinds of software developers: those who
    sandboxed Ghostscript, and those who should have sandboxed Ghostscript.”'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
- en: ^([3](ch17.html#ch17fn3-marker)) [Shellshock](https://oreil.ly/8eDCJ) was a
    remote exploit so simple to deploy that within a few days of its publication,
    millions of servers were already being actively attacked.
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
- en: ^([4](ch17.html#ch17fn4-marker)) This tight loop of effort has a minimal delay
    between steps, such that no one is unable to do their part because they’re waiting
    on someone else to complete their part.
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: ^([5](ch17.html#ch17fn5-marker)) A forensic timeline is a list of all the events
    that happened on a system, ideally centered on the events related to an investigation,
    ordered by the time at which those events occurred.
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
- en: ^([6](ch17.html#ch17fn6-marker)) Malware reversing is rather specialized work,
    and not all organizations have someone skilled in this practice.
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
- en: ^([7](ch17.html#ch17fn9-marker)) If an individual doesn’t have access to the
    actual information, they’re inclined to make something up.
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL

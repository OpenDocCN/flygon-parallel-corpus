- en: Giving Voice to Jarvis
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Ever wondered whether using robots to get our work done is possible? Well yes!
    Certainly in some high-tech fiction or Marvel movies or even comic books. So,
    get your seat belt tight and get ready for this amazing chapter where you will
    actually be implementing what I just mentioned.
  prefs: []
  type: TYPE_NORMAL
- en: 'This chapter will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Basic installation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Automatic delivery answering machine
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Making an interactive door answering robot
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Making Jarvis understand our voice
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Basic installation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are various ways and methods through which we can control our smart home
    Jarvis, some of which we have explored earlier such as controlling it through. So,
    to start with, we need to prepare our system to be able to do speech synthesis;
    to do that, let's perform the following process.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, go to the terminal and enter the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: What this will do is install the dependency `alsa-utils`. The `alsa-utils` package
    contains various utilities that are useful for controlling your sound drivers.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once this is done, you need to edit the file. To do it, we need to open the
    file. Use the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Once that is done, a file will open; at the bottom of that file, you need to
    add the following line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: You don't need to get too much into why we are doing it. It's just there to
    set things up. I can give you an explanation; however, I do not wish to bore you
    at this exciting moment.
  prefs: []
  type: TYPE_NORMAL
- en: Also, if you are lucky, then sometimes, you might find the line to be already
    present. If that is the case, then let it be there and don't touch it.
  prefs: []
  type: TYPE_NORMAL
- en: Now, to play the sounds that we need the Jarvis to say, we need an audio player.
    No, not the one that you have at your home. We are talking about the software
    that would play it.
  prefs: []
  type: TYPE_NORMAL
- en: 'To install the player, we need to run the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'All right, we are done with audio player; let''s see what we have next. Now,
    again, we need to edit the file of the media player. We will use the same steps
    to open the file and edit it:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'This will open the file. As before, simply add the following line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Finally, we need to give it some voice, so run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: This will install a 16 kHz, British, male, voice to Jarvis. We love British
    accents, don't we?
  prefs: []
  type: TYPE_NORMAL
- en: 'Perfect. Once we have done all of the steps mentioned previously, we would
    be good to go. To test the voice, simply connect a USB speaker to the Raspberry
    Pi and run the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'All right then, let''s see what we have actually done:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'As you might have figured out, we are importing the library named `os`. This
    library provides a way of using operating-system-dependent functionality:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: Here, we are using a method called `system()`; what this does is that it executes
    a shell command. You might be wondering what this is. A shell command is a command
    used by the user to access the functionality of a system to interact with it.
    So now that we want to convert our text to voice, we would be providing two arguments
    to this function. First, what is the text? In our case, it is `Hello from the
    other side`; the second argument that we have here is `festival --tts`. Now `festival`
    is a library, and `tts` stands for text to speech conversion. So when we pass
    it on to the argument, the system will know that the text passed on to the argument
    has to be converted from text to speech.
  prefs: []
  type: TYPE_NORMAL
- en: And that's it! Yes, that's it. That's all we have to do to make your Raspberry
    speak.
  prefs: []
  type: TYPE_NORMAL
- en: Automatic delivery answering machine
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'These days, we all order things online. Yet no matter how automated the process
    of Amazon is, when talking about 2018, we still have humans delivering the packages
    to our doorsteps. Sometimes, you want them to know a few things about where to
    leave the parcel. Now that we are becoming more and more automated, gone are the
    days when you might leave a note outside your gate. It''s time to make something
    really interesting with our technology. To do that, we hardly need to do anything
    serious. All we need to do is to wire up the components as shown in the following
    diagram:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](Images/b7b909b5-f145-40fc-bdb1-3d49aa5ffab9.png)'
  prefs: []
  type: TYPE_IMG
- en: The PIR sensor must be placed so that it gives a logic high whenever there is
    movement around the gate.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once that is done, go ahead and upload the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Now what we have done is very simple. As soon as the PIR sensor gives a logic
    high, a certain instruction is spoken. There is no need of an explanation. You
    can refer to the previous code if you need any clarification.
  prefs: []
  type: TYPE_NORMAL
- en: Making an interactive door – answering robot
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapter we have used a PIR sensor to sense any human activity,
    however the problem with the sensor is, that no matter who comes or leaves it
    would deliver the same message. That basically means that even when you come home
    after a long day, it would end up asking the same question. Pretty dumb huh?
  prefs: []
  type: TYPE_NORMAL
- en: So in this chapter we would use the previous repository and integrate the vision
    and the voice together to make an amazing duo. In this, the camera would identify
    who is on the gate and would recognize if it is a human and a stranger, if so
    then, it would deliver the message you intend to give. On the other hand if its
    you then it would simply let you pass with a simple greeting. However if the face
    is detected but not recognized then it would give a set of instructions to the
    person standing in-front of the camera.
  prefs: []
  type: TYPE_NORMAL
- en: 'To implement it all you need to do is to set up a camera on the gate of your
    door along with the PIR. The PIR is basically to activate the camera. In other
    words the camera would not get activated till the time no movement is detected.
    This set up is very straight forward and does not need any GPIO to be used. Simply
    fix the camera and PIR and upload the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: In the preceding code, we are creating a cascade classifier using the method
    `CascadeClassifier` so that faces can be detected by the camera.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: In the preceding code, we are reading the frames from the camera using `VideoCapture(0)`
    method of `cv2`. Also, the face recognizer is being created to recognize a particular
    face.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: Now read the data from the camera using `cam.read()` as done in the previous
    code.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: The images are converted into gray color. Then, `faceDetect.detectMultiScale()`
    will be using the gray color-converted images.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'As the face is detected, the part of the image containing the face will be
    converted into gray and passed to a predict function. This method will tell if
    the face is known or not, it also returns the ID if the face is identified. Suppose
    the person is `BEN`, then Jarvis would say `Hello, welcome to my house BEN`. Now
    `BEN` can tell the Jarvis to turn on the lights, and the Jarvis would respond
    as the wake word Jarvis gets activated. And if the person is not recognized, then
    maybe it was a delivery boy. Then, the following commands get executed:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: Making Jarvis understand our voice
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Voice is an essence of communication. It helps us transfer huge amounts of data
    in a very short period of time. It is certainly faster and easier than typing.
    Hence, more and more companies are working toward making systems that understands
    human voice and language and work according to them. It is certainly not easy
    because of the huge variations that are present in the language; however, we have
    come a considerable distance. So without much time, let's make our system get
    ready to recognize our voice.
  prefs: []
  type: TYPE_NORMAL
- en: So here, we would be using an API from Google Voice. As you may know, Google
    is really good at understanding what you say. Like, very literally. So it makes
    sense to use their API. Now, the way it works is very simple. We capture the voice,
    and we convert it into the text. Then, we compare if the text is similar to something
    we have defined in the configuration file. If it matches with anything, the bash
    command associated with it will be executed.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to check whether the microphone is connected. To do that, run
    the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: This command will show you a list of devices connected on USB. If you see yours
    on the list, then thumbs up, you are on the right track. Otherwise, try finding
    it with the connection or maybe try another hardware.
  prefs: []
  type: TYPE_NORMAL
- en: 'We also need to set the recording volume to high. To do this, go ahead and
    type the following command on the serial:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Now once the GUI pops on to the screen, toggle the volume using the arrow keys.
  prefs: []
  type: TYPE_NORMAL
- en: 'It''s best to hear the sound recorded by yourself rather than directly giving
    it down to the Raspberry. To do that first, we need to record our voice, so we
    need to run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: 'This will check whether the webcam is on the list. Then, write the following
    command to record:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: The sound will be recorded with the following name, `First.wav`.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now we would also like to listen to what we just recorded. The simple way to
    do that is by typing the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: Check whether the voice is correct. If not, then you are free to make any adjustments
    to the system.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once we are done with checking the sound and the microphone, it''s time to
    install the real software for the job. There are simple ways with which you can
    do it. The following is a list of commands that you need to run:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: Now when you run this, very interesting things will start to happen. It will
    start to ask you various questions. Some of them will be straightforward. You
    can use your right mind to give the answers to it in the form of yes or no. Others
    could be very technical. As these questions might change over time, there seems
    to be no need to explicitly mention the answers that you need to fill, but as
    a general rule of thumb—Give it a yes unless it's something you really want to
    say no to.
  prefs: []
  type: TYPE_NORMAL
- en: 'Perfect then, we have installed the software. Now before you go any further
    in that software, let''s go ahead and write the following programs:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: 'Whenever this program runs, the light that is connected on PIN number `2` will
    be turned on. Also, it will read out `LIGHTS TURNED ON`. Save this file with the
    name `lighton.py`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: 'Similarly, in this program, the light would be turned off and it would read
    out `LIGHTS TURNED OFF`. Save it by the name `lightoff.py`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: 'Now we are doing the same thing for the fan as well. In this one, the fan will
    be switched on; save it with the name `fanon.py`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: I don't need to explain the same thing for this do I? As you will have guessed,
    save it with the name `fanoff.py`.
  prefs: []
  type: TYPE_NORMAL
- en: 'All right! When all of this is done, then type the following command to check
    whether the software is installed properly:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: 'Raspberry Pi responds to the wake word `pi`; let''s change it to `jarvis`.
    All these changes can be made after opening the configuration file using the following
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: 'In that file, enter the commands of your own. Here, let''s add the following
    code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: 'Now for each command, define the action. The action would be to run the Python
    file that contains the code for switching the lights and fan on or off. The code
    is basic and simple to understand. Add the following to the file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: Now, let's see what we have done. Whenever you say <q>Jarvis, light on</q>, it
    will convert your speed to text, compare it with the program that it has to run
    corresponding to it and will do whatever is there in the program. Hence, in this
    program, whenever we say <q>Light on,</q> the lights will be turned on and similarly
    for the rest of the commands as well. Remember to make it listen to what you are
    saying. You would have to say the word, <q>Jarvis,</q> which will make it attentive
    to the commands and ready to listen.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we understood how to interact and make the Jarvis work according
    to our needs. If this chapter was about verbal communication, then the next chapter
    is about gesture recognition where, using advanced capacitive techniques, you
    will be able to control your automation system just by waving at it.
  prefs: []
  type: TYPE_NORMAL

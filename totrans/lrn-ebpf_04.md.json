["```cpp\nintbpf(intcmd,unionbpf_attr*attr,unsignedintsize);\n```", "```cpp\nstructuser_msg_t{![1](assets/1.png)charmessage[12];};BPF_HASH(config,u32,structuser_msg_t);![2](assets/2.png)BPF_PERF_OUTPUT(output);![3](assets/3.png)structdata_t{![4](assets/4.png)intpid;intuid;charcommand[16];charmessage[12];};inthello(void*ctx){![5](assets/5.png)structdata_tdata={};structuser_msg_t*p;charmessage[12]=\"Hello World\";data.pid=bpf_get_current_pid_tgid()>>32;data.uid=bpf_get_current_uid_gid()&0xFFFFFFFF;bpf_get_current_comm(&data.command,sizeof(data.command));p=config.lookup(&data.uid);![6](assets/6.png)if(p!=0){bpf_probe_read_kernel(&data.message,sizeof(data.message),p->message);}else{bpf_probe_read_kernel(&data.message,sizeof(data.message),message);}output.perf_submit(ctx,&data,sizeof(data));return0;}\n```", "```cpp\nb[\"config\"][ct.c_int(0)] = ct.create_string_buffer(b\"Hey root!\")\nb[\"config\"][ct.c_int(501)] = ct.create_string_buffer(b\"Hi user 501!\")\n```", "```cpp\nTerminal 1                             Terminal 2\n$ ./hello-buffer-config.py \n37926 501 bash Hi user 501!            ls \n37927 501 bash Hi user 501!            sudo ls\n37929 0 sudo Hey root!\n37931 501 bash Hi user 501!            sudo -u daemon ls\n37933 1 sudo Hello World\n```", "```cpp\n$ strace -e bpf ./hello-buffer-config.py\n```", "```cpp\nbpf(BPF_BTF_LOAD, ...) = 3\nbpf(BPF_MAP_CREATE, {map_type=BPF_MAP_TYPE_PERF_EVENT_ARRAY\u2026) = 4\nbpf(BPF_MAP_CREATE, {map_type=BPF_MAP_TYPE_HASH...) = 5\nbpf(BPF_PROG_LOAD, {prog_type=BPF_PROG_TYPE_KPROBE,...prog_name=\"hello\",...) = 6\nbpf(BPF_MAP_UPDATE_ELEM, ...}\n...\n```", "```cpp\nbpf(BPF_BTF_LOAD, {btf=\"\\237\\353\\1\\0...}, 128) = 3\n```", "```cpp\nbpf(BPF_MAP_CREATE, {map_type=BPF_MAP_TYPE_PERF_EVENT_ARRAY, , key_size=4, \nvalue_size=4, max_entries=4, ... map_name=\"output\", ...}, 128) = 4\n```", "```cpp\nbpf(BPF_MAP_CREATE, {map_type=BPF_MAP_TYPE_HASH, key_size=4, value_size=12,\nmax_entries=10240... map_name=\"config\", ...btf_fd=3,...}, 128) = 5\n```", "```cpp\nbpf(BPF_PROG_LOAD, {prog_type=BPF_PROG_TYPE_KPROBE, insn_cnt=44,\ninsns=0xffffa836abe8, license=\"GPL\", ... prog_name=\"hello\", ... \nexpected_attach_type=BPF_CGROUP_INET_INGRESS, prog_btf_fd=3,...}, 128) = 6\n```", "```cpp\nb[\"config\"][ct.c_int(0)] = ct.create_string_buffer(b\"Hey root!\")\nb[\"config\"][ct.c_int(501)] = ct.create_string_buffer(b\"Hi user 501!\")\n```", "```cpp\nbpf(BPF_MAP_UPDATE_ELEM, {map_fd=5, key=0xffffa7842490, value=0xffffa7a2b410,\nflags=BPF_ANY}, 128) = 0\n```", "```cpp\n$ bpftool map dump name config\n[{\n        \"key\": 0,\n        \"value\": {\n            \"message\": \"Hey root!\"\n        }\n    },{\n        \"key\": 501,\n        \"value\": {\n            \"message\": \"Hi user 501!\"\n        }\n    }\n]\n```", "```cpp\nbpftool prog load hello.bpf.o /sys/fs/bpf/hello\n```", "```cpp\nip link set dev eth0 xdp obj hello.bpf.o sec xdp\n```", "```cpp\n$ bpftool prog list\n\u2026 \n1255: xdp  name hello  tag 9d0e949f89f1a82c  gpl\n        loaded_at 2022-11-01T19:21:14+0000  uid 0\n        xlated 48B  jited 108B  memlock 4096B  map_ids 612\n```", "```cpp\nbpf(BPF_MAP_UPDATE_ELEM, {map_fd=4, key=0xffffa7842490, value=0xffffa7a2b410,\nflags=BPF_ANY}, 128) = 0\n```", "```cpp\n$ strace -e bpf,perf_event_open,ioctl,ppoll ./hello-buffer-config.py\n```", "```cpp\nperf_event_open({type=0x6 /* PERF_TYPE_??? */, ...},...) = 7\n```", "```cpp\n$ cat /sys/bus/event_source/devices/kprobe/type\n6\n```", "```cpp\nioctl(7, PERF_EVENT_IOC_SET_BPF, 6)     = 0\n```", "```cpp\nioctl(7, PERF_EVENT_IOC_ENABLE, 0)      = 0\n```", "```cpp\nperf_event_open({type=PERF_TYPE_SOFTWARE, size=0 /* PERF_ATTR_SIZE_??? */, \nconfig=PERF_COUNT_SW_BPF_OUTPUT, ...}, -1, X, -1, PERF_FLAG_FD_CLOEXEC) = Y\n\nioctl(Y, PERF_EVENT_IOC_ENABLE, 0)      = 0\n\nbpf(BPF_MAP_UPDATE_ELEM, {map_fd=4, key=0xffffa7842490, value=0xffffa7a2b410,\nflags=BPF_ANY}, 128) = 0\n```", "```cpp\nppoll([{fd=8, events=POLLIN}, {fd=9, events=POLLIN}, {fd=10, events=POLLIN},\n{fd=11, events=POLLIN}], 4, NULL, NULL, 0) = 1 ([{fd=8, revents=POLLIN}])\n```", "```cpp\nbpf(BPF_MAP_CREATE, {map_type=BPF_MAP_TYPE_RINGBUF, key_size=0, value_size=0,\nmax_entries=4096, ... map_name=\"output\", ...}, 128) = 4\n```", "```cpp\nppoll([{fd=8, events=POLLIN}, {fd=9, events=POLLIN}, {fd=10, events=POLLIN},\n{fd=11, events=POLLIN}], 4, NULL, NULL, 0) = 1 ([{fd=8, revents=POLLIN}])\n```", "```cpp\nepoll_create1(EPOLL_CLOEXEC) = 8\n```", "```cpp\nepoll_ctl(8, EPOLL_CTL_ADD, 4, {events=EPOLLIN, data={u32=0, u64=0}}) = 0\n```", "```cpp\nepoll_pwait(8,  [{events=EPOLLIN, data={u32=0, u64=0}}], 1, -1, NULL, 8) = 1\n```", "```cpp\n$ strace -e bpf bpftool map dump name config\n```", "```cpp\nbpf(BPF_MAP_GET_NEXT_ID, {start_id=0,...}, 12) = 0             ![1](assets/1.png)\nbpf(BPF_MAP_GET_FD_BY_ID, {map_id=48...}, 12) = 3              ![2](assets/2.png)\nbpf(BPF_OBJ_GET_INFO_BY_FD, {info={bpf_fd=3, ...}}, 16) = 0    ![3](assets/3.png)\n\nbpf(BPF_MAP_GET_NEXT_ID, {start_id=48, ...}, 12) = 0           ![4](assets/4.png)\nbpf(BPF_MAP_GET_FD_BY_ID, {map_id=116, ...}, 12) = 3\nbpf(BPF_OBJ_GET_INFO_BY_FD, {info={bpf_fd=3...}}, 16) = 0\n```", "```cpp\nbpf(BPF_MAP_GET_NEXT_ID, {start_id=133,...}, 12) = -1 ENOENT (No such file or\ndirectory)\n```", "```cpp\nbpf(BPF_MAP_GET_NEXT_KEY, {map_fd=3, key=NULL,                    ![1](assets/1.png)\nnext_key=0xaaaaf7a63960}, 24) = 0\nbpf(BPF_MAP_LOOKUP_ELEM, {map_fd=3, key=0xaaaaf7a63960,           ![2](assets/2.png)\nvalue=0xaaaaf7a63980, flags=BPF_ANY}, 32) = 0\n[{                                                                ![3](assets/3.png)\n        \"key\": 0,\n        \"value\": {\n            \"message\": \"Hey root!\"\n        }\nbpf(BPF_MAP_GET_NEXT_KEY, {map_fd=3, key=0xaaaaf7a63960,          ![4](assets/4.png)\nnext_key=0xaaaaf7a63960}, 24) = 0\nbpf(BPF_MAP_LOOKUP_ELEM, {map_fd=3, key=0xaaaaf7a63960, \nvalue=0xaaaaf7a63980, flags=BPF_ANY}, 32) = 0\n    },{                                                   \n        \"key\": 501,\n        \"value\": {\n            \"message\": \"Hi user 501!\"\n        }\nbpf(BPF_MAP_GET_NEXT_KEY, {map_fd=3, key=0xaaaaf7a63960,          ![5](assets/5.png)\nnext_key=0xaaaaf7a63960}, 24) = -1 ENOENT (No such file or directory)\n    }                                                             ![6](assets/6.png)\n]\n+++ exited with 0 +++\n```", "```cpp\n    bpftool prog pin name hello /sys/fs/bpf/hi\n    ```", "```cpp\n    bpf(BPF_RAW_TRACEPOINT_OPEN, {raw_tracepoint={name=\"sys_enter\",\n    prog_fd=6}}, 128) = 7\n    ```", "```cpp\n    $ bpftool link list\n    116: perf_event  prog 1849  \n            bpf_cookie 0\n            pids opensnoop(17711)\n    117: perf_event  prog 1851  \n            bpf_cookie 0\n            pids opensnoop(17711)\n    ```", "```cpp\n    $ bpftool prog list\n    ...\n    1849: tracepoint  name tracepoint__syscalls__sys_enter_openat\n            tag 8ee3432dcd98ffc3  gpl run_time_ns 95875 run_cnt 121\n            loaded_at 2023-01-08T15:49:54+0000  uid 0\n            xlated 240B  jited 264B  memlock 4096B  map_ids 571,568\n            btf_id 710\n            pids opensnoop(17711)\n    1851: tracepoint  name tracepoint__syscalls__sys_exit_openat\n            tag 387291c2fb839ac6  gpl run_time_ns 8515669 run_cnt 120\n            loaded_at 2023-01-08T15:49:54+0000  uid 0\n            xlated 696B  jited 744B  memlock 4096B  map_ids 568,571,569\n            btf_id 710\n            pids opensnoop(17711)\n    ```"]